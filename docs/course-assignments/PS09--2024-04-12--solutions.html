<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Math87-Tufts University - PS 9 -- Least squares and curve-fitting</title>
	<script>
	  window.MathJax = {
	    options: {
	      ignoreHtmlClass: 'tex2jax_ignore',
	      processHtmlClass: 'tex2jax_process'
	    },
	    tex: {
	      autoload: {
		color: [],
		colorv2: ['color']
	      },
	      packages: {'[+]': ['noerrors']}
	    },
	    loader: {
	      load: ['input/asciimath', '[tex]/noerrors']
	    }
	  };
	</script>
	<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>
        <link rel="stylesheet" href="../css/default.css" />
	<link rel="stylesheet" href="../css/haddock.css" />
	
	<link href="https://fonts.googleapis.com/css?family=Lato:400,700" type="text/css" rel="stylesheet" media="screen" />
	<link href="https://fonts.googleapis.com/css?family=Arimo:400,700" type="text/css" rel="stylesheet" media="screen" />
	<link href="https://fonts.googleapis.com/css?family=Roboto:400,700" type="text/css" rel="stylesheet" media="screen" />
	<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700" type="text/css" rel="stylesheet" media="screen" />
	<link href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" type="text/css" rel="stylesheet" media="screen" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous" />			
    </head>
    <body>
        <header>
          <div class="logo">
            <a href="../">
	      Math87 - Spring 2024 - Tufts Univ</a>
          </div>
          <nav>
            <a href="../about.html">About</a>
	    <a href="../course-pages/Math087--course-info.html">Info</a>	    
            <a href="../archive.html">Archive</a>
          </nav>
        </header>

        <main role="main">
            <h1>PS 9 -- Least squares and curve-fitting</h1>
            <ol type="1">
<li><p><em>Mass estimation</em><br />
Suppose you are assembling components for a piece of heavy
machinery. The final product involves 5 components, <code>a</code>, <code>b</code>, <code>c</code>,
<code>d</code>, and <code>e</code>. You require estimates for the total mass of each of
the components.</p>
<p>You have take measurements of the mass of <em>groups</em> of the components:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>mass_estimates <span class="op">=</span> {(<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>): <span class="fl">551.03</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                  (<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'d'</span>): <span class="fl">353.19</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                  (<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'e'</span>): <span class="fl">574.36</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                  (<span class="st">'a'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>): <span class="fl">506.1</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                  (<span class="st">'a'</span>, <span class="st">'c'</span>, <span class="st">'e'</span>): <span class="fl">724.92</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                  (<span class="st">'a'</span>, <span class="st">'d'</span>, <span class="st">'e'</span>): <span class="fl">531.9</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                  (<span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>): <span class="fl">478.21</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                  (<span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'e'</span>): <span class="fl">701.98</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                  (<span class="st">'b'</span>, <span class="st">'d'</span>, <span class="st">'e'</span>): <span class="fl">504.75</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                  (<span class="st">'c'</span>, <span class="st">'d'</span>, <span class="st">'e'</span>): <span class="fl">653.07</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                  }</span></code></pre></div>
<p>For example, the equality</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mass_estimates[(<span class="st">'a'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>)] <span class="op">==</span> <span class="fl">551.03</span></span></code></pre></div>
<p>means
that the sum of the masses of components <code>a</code>, <code>b</code>, and <code>c</code> is
<code>551.03</code>.</p>
<p>Let’s write <code>ma</code>,<code>mb</code>,<code>mc</code>,<code>md</code>,<code>me</code> for the masses of the
components.</p>
<p>The estimates amount to linear equations in the variables <code>ma</code>, <code>mb</code>, …
e.g. we have</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ma <span class="op">+</span> mb <span class="op">+</span> mc <span class="op">==</span> <span class="fl">551.03</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ma <span class="op">+</span> mb <span class="op">+</span> md <span class="op">==</span> <span class="fl">353.19</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>ma <span class="op">+</span> mb <span class="op">+</span> me <span class="op">==</span> <span class="fl">576.36</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ... etc ...</span></span></code></pre></div>
<p>Write</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> array([<span class="fl">551.03</span>, <span class="fl">353.19</span>, <span class="fl">574.36</span>, <span class="fl">506.1</span>, <span class="fl">724.92</span>, <span class="fl">531.9</span>, <span class="fl">478.21</span>, <span class="fl">701.98</span>, <span class="fl">504.75</span>, <span class="fl">653.07</span>])</span></code></pre></div>
<ol type="a">
<li><p>Find an estimate for the vector</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> array([ ma, mb, mc, md, me ])</span></code></pre></div>
<p>which is the <em>least squares solution</em> to the equation</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>M <span class="op">@</span> x <span class="op">=</span> b</span></code></pre></div>
<p>Put another way, find the
vector <code>x</code> as above such that
the length of the vector</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>b <span class="op">-</span> M <span class="op">@</span> x</span></code></pre></div>
<p>is minimized.</p>
<div class="solution">
<p>We begin with</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy.linalg <span class="im">as</span> la</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>mass_estimates <span class="op">=</span> {(<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>): <span class="fl">551.03</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                  (<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'d'</span>): <span class="fl">353.19</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                  (<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'e'</span>): <span class="fl">574.36</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                  (<span class="st">'a'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>): <span class="fl">506.1</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                  (<span class="st">'a'</span>, <span class="st">'c'</span>, <span class="st">'e'</span>): <span class="fl">724.92</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                  (<span class="st">'a'</span>, <span class="st">'d'</span>, <span class="st">'e'</span>): <span class="fl">531.9</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                  (<span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>): <span class="fl">478.21</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>                  (<span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'e'</span>): <span class="fl">701.98</span>,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>                  (<span class="st">'b'</span>, <span class="st">'d'</span>, <span class="st">'e'</span>): <span class="fl">504.75</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>                  (<span class="st">'c'</span>, <span class="st">'d'</span>, <span class="st">'e'</span>): <span class="fl">653.07</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>                  }</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="fl">551.03</span>, <span class="fl">353.19</span>, <span class="fl">574.36</span>, <span class="fl">506.1</span>, <span class="fl">724.92</span>, <span class="fl">531.9</span>, <span class="fl">478.21</span>, <span class="fl">701.98</span>, <span class="fl">504.75</span>, <span class="fl">653.07</span>])	  </span></code></pre></div>
<p>The first task is to produce the matrix <code>M</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sbv(i,n):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># return the ith standard basis vector of length n</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([<span class="dv">1</span> <span class="cf">if</span> j <span class="op">==</span> i <span class="cf">else</span> <span class="dv">0</span> <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n)])</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sbv_list(elem,ls):</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># return the standard basis vector determined by the position of `elem` in the list `ls`</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sbv(<span class="bu">list</span>(ls).index(elem),<span class="bu">len</span>(ls))</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>parts <span class="op">=</span> [<span class="st">'a'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>,<span class="st">'d'</span>,<span class="st">'e'</span>]</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> np.array([sbv_list(x,parts) <span class="op">+</span> sbv_list(y,parts) <span class="op">+</span> sbv_list(z,parts) <span class="cf">for</span> (x,y,z) <span class="kw">in</span> mass_estimates.keys()])</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>M </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>array([[<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>]])</span></code></pre></div>
<p>Now we can use <code>numpy.linalg.lstsq</code> to find the required least-squares solution.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sol <span class="op">=</span> la.lstsq(M,b,rcond<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sol[<span class="dv">0</span>]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>array([<span class="fl">150.58166667</span>, <span class="fl">124.58833333</span>, <span class="fl">275.185</span>     ,  <span class="fl">79.155</span>     ,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>       <span class="fl">300.40833333</span>])</span></code></pre></div>
<p>This indicates the best estimate for the masses:
<span class="math display">\[\begin{bmatrix} ma \\ mb \\ mc \\ md \\ me \end{bmatrix} \approx
\begin{bmatrix} 150.58166667\\ 124.58833333\\ 275.185     \\  79.155     \\
       300.40833333 \end{bmatrix}.\]</span></p>
</div></li>
<li><p>Using your <em>least-squares solution</em> from a., estimate the total mass of the
assembled machine; i.e. estimate the sum</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ma <span class="op">+</span> mb <span class="op">+</span> mc <span class="op">+</span> md <span class="op">+</span> me </span></code></pre></div>
<div class="solution">
<p>The total mass is the sum <span class="math inline">\(ma + mb + mc + md + me\)</span>.</p>
<p>We can compute this as follows:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sol[<span class="dv">0</span>]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>array([<span class="fl">150.58166667</span>, <span class="fl">124.58833333</span>, <span class="fl">275.185</span>     ,  <span class="fl">79.155</span>     ,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>       <span class="fl">300.40833333</span>])</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>sol[<span class="dv">0</span>]</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>(x)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fl">929.9183333333333</span></span></code></pre></div>
<p>Thus the total mass is <span class="math inline">\(\approx 929.9183\)</span> <code>kg</code>.</p>
</div></li>
<li><p>Explain why you know that the equation</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>M <span class="op">@</span> x <span class="op">==</span> b</span></code></pre></div>
<p>has no solution <code>x</code>.</p>
<div class="solution">
<p>If
<code>M @ x == b</code>
had a solution,
that solution would be the <em>least squares</em> solution. And thus the
<em>residual</em> <code>b - M @x</code> would be 0.</p>
<p>But the residual vector is given by</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>b <span class="op">-</span> M <span class="op">@</span> x</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>array([ <span class="fl">0.675</span>     , <span class="op">-</span><span class="fl">1.135</span>     , <span class="op">-</span><span class="fl">1.21833333</span>,  <span class="fl">1.17833333</span>, <span class="op">-</span><span class="fl">1.255</span>     ,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        <span class="fl">1.755</span>     , <span class="op">-</span><span class="fl">0.71833333</span>,  <span class="fl">1.79833333</span>,  <span class="fl">0.59833333</span>, <span class="op">-</span><span class="fl">1.67833333</span>])</span></code></pre></div>
<p>Since this vector is non-zero, there is no solution to <code>M @ x == b</code>.</p>
</div></li>
</ol></li>
<li><p><em>Curve fitting</em></p>
<p>An object was catapulted vertically into the air from atop a tall
building – it traveled upwards, then fell straight to the
ground.</p>
<p>The object was equipped with an altimeter and a recorder, so you
have some data about its height above ground at various points
during its flight.</p>
<p>Neglecting air resistance, we know from physics that the height above
ground of the object is a <em>quadratic</em> function</p>
<p><span class="math display">\[f(t) = \alpha t^2 + \beta t + \delta.\]</span></p>
<p>The following dictionary <code>height_esimates</code> indicates the height
<code>height_estimates[t]</code> in meters above ground of the object after
<code>t</code> seconds:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>height_estimates <span class="op">=</span> {<span class="fl">0.0</span>: <span class="fl">199.6</span>,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">0.25</span>: <span class="fl">202.96</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">0.5</span>: <span class="fl">207.23</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">0.75</span>: <span class="fl">208.29</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">1.0</span>: <span class="fl">207.47</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">1.25</span>: <span class="fl">203.96</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">1.5</span>: <span class="fl">199.18</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">1.75</span>: <span class="fl">202.91</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">2.0</span>: <span class="fl">204.29</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">2.25</span>: <span class="fl">196.31</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">2.5</span>: <span class="fl">195.71</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">2.75</span>: <span class="fl">187.89</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">3.0</span>: <span class="fl">187.61</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">3.25</span>: <span class="fl">177.12</span>,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">3.5</span>: <span class="fl">171.07</span>,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">3.75</span>: <span class="fl">171.89</span>,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">4.0</span>: <span class="fl">158.68</span>,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">4.25</span>: <span class="fl">152.64</span>,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">4.5</span>: <span class="fl">146.7</span>,</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">4.75</span>: <span class="fl">138.52</span>,</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">5.0</span>: <span class="fl">127.27</span>,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">5.25</span>: <span class="fl">122.38</span>,</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">5.5</span>: <span class="fl">103.97</span>,</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">5.75</span>: <span class="fl">96.91</span>,</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">6.0</span>: <span class="fl">83.08</span>,</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">6.25</span>: <span class="fl">67.34</span>,</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">6.5</span>: <span class="fl">55.75</span>,</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">6.75</span>: <span class="fl">45.42</span>,</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">7.0</span>: <span class="fl">25.33</span>,</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">7.25</span>: <span class="fl">14.67</span>,</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">7.5</span>: <span class="op">-</span><span class="fl">1.45</span>}</span></code></pre></div>
<p>We can see a graph of these values as follows</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_data(x,y):</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">6</span>))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ax.plot(x,y,<span class="st">&quot;o&quot;</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> height_estimates.keys()</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> <span class="bu">list</span>(height_estimates.values())</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>plot_data(x1,y1)   </span></code></pre></div>
<ol type="a">
<li><p>Find the values of the coefficients <span class="math inline">\(\alpha,\beta,\delta\)</span>
so that
<span class="math display">\[f(t) = \alpha t^2 + \beta t + \delta.\]</span>
is the <em>best fit</em> for the available data.
What is the initial height above ground (i.e. the height of the tall building?)
What is the initial velocity of the object?</p>
<div class="solution">
<p>We need to produce the matrix <span class="math inline">\(M\)</span> and vector <span class="math inline">\(\mathbf{b}\)</span> determined
by the altimeter data for which
<span class="math display">\[M \begin{bmatrix} \alpha \\ \beta \\ \delta \end{bmatrix} \approx \mathbf{y}.\]</span></p>
<p>The entries in <span class="math inline">\(\mathbf{y}\)</span> are exactly the values in the dictionary <code>height_estimates</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array(height_estimates.values())</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>y<span class="op">=&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>array([<span class="fl">199.6</span> , <span class="fl">202.96</span>, <span class="fl">207.23</span>, <span class="fl">208.29</span>, <span class="fl">207.47</span>, <span class="fl">203.96</span>, <span class="fl">199.18</span>, <span class="fl">202.91</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>       <span class="fl">204.29</span>, <span class="fl">196.31</span>, <span class="fl">195.71</span>, <span class="fl">187.89</span>, <span class="fl">187.61</span>, <span class="fl">177.12</span>, <span class="fl">171.07</span>, <span class="fl">171.89</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>       <span class="fl">158.68</span>, <span class="fl">152.64</span>, <span class="fl">146.7</span> , <span class="fl">138.52</span>, <span class="fl">127.27</span>, <span class="fl">122.38</span>, <span class="fl">103.97</span>,  <span class="fl">96.91</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>        <span class="fl">83.08</span>,  <span class="fl">67.34</span>,  <span class="fl">55.75</span>,  <span class="fl">45.42</span>,  <span class="fl">25.33</span>,  <span class="fl">14.67</span>,  <span class="op">-</span><span class="fl">1.45</span>])</span></code></pre></div>
<p>The <em>rows</em> of the matrix <span class="math inline">\(M\)</span> have the form <span class="math inline">\(\begin{bmatrix} t^2 &amp; t &amp; 1 \end{bmatrix}\)</span>
for each value <span class="math inline">\(t\)</span> in <code>height_estimates.keys()</code>.</p>
<p>Thus</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> np.array([[t<span class="op">**</span><span class="dv">2</span>, t, <span class="dv">1</span>] <span class="cf">for</span> t <span class="kw">in</span> height_estimates.keys()])</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>M</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>array([[ <span class="fl">0.</span>    ,  <span class="fl">0.</span>    ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.0625</span>,  <span class="fl">0.25</span>  ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.25</span>  ,  <span class="fl">0.5</span>   ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.5625</span>,  <span class="fl">0.75</span>  ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">1.</span>    ,  <span class="fl">1.</span>    ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">1.5625</span>,  <span class="fl">1.25</span>  ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">2.25</span>  ,  <span class="fl">1.5</span>   ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">3.0625</span>,  <span class="fl">1.75</span>  ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">4.</span>    ,  <span class="fl">2.</span>    ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">5.0625</span>,  <span class="fl">2.25</span>  ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">6.25</span>  ,  <span class="fl">2.5</span>   ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">7.5625</span>,  <span class="fl">2.75</span>  ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">9.</span>    ,  <span class="fl">3.</span>    ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">10.5625</span>,  <span class="fl">3.25</span>  ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">12.25</span>  ,  <span class="fl">3.5</span>   ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">14.0625</span>,  <span class="fl">3.75</span>  ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">16.</span>    ,  <span class="fl">4.</span>    ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">18.0625</span>,  <span class="fl">4.25</span>  ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">20.25</span>  ,  <span class="fl">4.5</span>   ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">22.5625</span>,  <span class="fl">4.75</span>  ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">25.</span>    ,  <span class="fl">5.</span>    ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">27.5625</span>,  <span class="fl">5.25</span>  ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">30.25</span>  ,  <span class="fl">5.5</span>   ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">33.0625</span>,  <span class="fl">5.75</span>  ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">36.</span>    ,  <span class="fl">6.</span>    ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">39.0625</span>,  <span class="fl">6.25</span>  ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">42.25</span>  ,  <span class="fl">6.5</span>   ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">45.5625</span>,  <span class="fl">6.75</span>  ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">49.</span>    ,  <span class="fl">7.</span>    ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">52.5625</span>,  <span class="fl">7.25</span>  ,  <span class="fl">1.</span>    ],</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">56.25</span>  ,  <span class="fl">7.5</span>   ,  <span class="fl">1.</span>    ]])</span></code></pre></div>
<p>To estimate the coefficients <span class="math inline">\(\alpha,\beta,\delta\)</span>, we find the least squares solution
to <code>M @ x == y</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>sol <span class="op">=</span> la.lstsq(M,y,rcond<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>sol</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>(array([ <span class="op">-</span><span class="fl">4.87577207</span>,   <span class="fl">9.52224214</span>, <span class="fl">201.12954545</span>]),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a> array([<span class="fl">197.4818912</span>]),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a> array([<span class="fl">145.51191959</span>,   <span class="fl">6.8395201</span> ,   <span class="fl">1.73156458</span>]))</span></code></pre></div>
<p>Thus <code>sol[0]</code> contains the coefficients <span class="math inline">\(\alpha,\beta,\delta\)</span>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>alpha,beta,delta<span class="op">=</span>sol[<span class="dv">0</span>]</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Q(x) = </span><span class="sc">{</span>alpha<span class="sc">:.03f}</span><span class="ss">*t^2 + </span><span class="sc">{</span>beta<span class="sc">:.03f}</span><span class="ss">*t + </span><span class="sc">{</span>delta<span class="sc">:.03f}</span><span class="ss">&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>Q(x) <span class="op">=</span> <span class="op">-</span><span class="fl">4.876</span><span class="op">*</span>t<span class="op">^</span><span class="dv">2</span> <span class="op">+</span> <span class="fl">9.522</span><span class="op">*</span>t <span class="op">+</span> <span class="fl">201.130</span></span></code></pre></div>
<p>Let’s define <code>Q</code> as a (<code>python</code>) function</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Q(t):</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a> <span class="cf">return</span> alpha<span class="op">*</span>t<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> beta<span class="op">*</span>t <span class="op">+</span> delta    </span></code></pre></div>
<p>The initial height of the object is (approximately) the <em>constant term</em> of <code>Q</code>, namely <span class="math inline">\(\delta\)</span></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>delta    <span class="co">## initial height</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fl">201.12954545454554</span></span></code></pre></div>
<p>The initial velocity of the object is (approximately) the <em>coefficient of <span class="math inline">\(t\)</span></em> in <code>Q</code>, namely,
<span class="math inline">\(\beta\)</span>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>beta    <span class="co">## initial velocity</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fl">9.522242137728753</span></span></code></pre></div>
</div></li>
<li><p>Produce via <code>matplotlib</code> a graph of the function <code>f</code> you
obtained as the best-fit in a., superimposed on the data plot
above. (You can use the code from the lecture notebook).</p>
<div class="solution">
<p>We use this code</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_curve_fit(x0,f,x,y):</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># graph the line with slope alpha and y-intercept beta, and plot the data points</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    fig,ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">6</span>))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ax.plot(x,alpha1*x + beta1)</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    ax.plot(x,y,<span class="st">'o'</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    ax.plot(x0,f(x0))</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fig,ax</span></code></pre></div>
<p>to plot <span class="math inline">\(Q\)</span> superimposed on the data-plot.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>plot_curve_fit(x,Q,x,y)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span></code></pre></div>
<p><img src="../course-assets/images/ps09-image-01.png" /></p>
</div></li>
<li><p>Since we know that acceleration due to gravity is
(approximately) -9.8 m/s near the Earth’s surface, we actually
know that the function <span class="math inline">\(f\)</span> should be given by <span class="math display">\[(\clubsuit) \quad f(t)
= \dfrac{-9.8}{2}t^2 + \beta t + \delta.\]</span></p>
<p>Now find the values of the coefficients <span class="math inline">\(\beta,\delta\)</span> so that
<span class="math inline">\((\clubsuit)\)</span> is the <em>best fit</em> for the available data.</p>
<p>Are your estimates for the height of the building or the initial
velocity affected by this simplification?</p>
<div class="solution">
<p>We note that we need to find <span class="math inline">\(\beta,\delta\)</span>; each data point
<span class="math inline">\((t,y)\)</span> determined from an altimeter reading yields an equation
<span class="math display">\[\beta t + \delta = \dfrac{9.8}{2} t + y\]</span></p>
<p>Thus we consider the matrix <code>N</code> whose
rows are <span class="math inline">\(\begin{bmatrix} t &amp; 1 \end{bmatrix}\)</span> for each <code>t</code> in <code>height_estimates.keys()</code>.</p>
<p>And we consider the vector <code>z</code> whose entries are
<code>9.8/2 * t + height_estimates[t]</code> for each <code>t</code> in <code>height_estimates.keys()</code>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> np.array([[t,<span class="dv">1</span>] <span class="cf">for</span> t <span class="kw">in</span> height_estimates.keys()])</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>N</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>array([[<span class="fl">0.</span>  , <span class="fl">1.</span>  ],</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">0.25</span>, <span class="fl">1.</span>  ],</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">0.5</span> , <span class="fl">1.</span>  ],</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">0.75</span>, <span class="fl">1.</span>  ],</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">1.</span>  , <span class="fl">1.</span>  ],</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">1.25</span>, <span class="fl">1.</span>  ],</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">1.5</span> , <span class="fl">1.</span>  ],</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">1.75</span>, <span class="fl">1.</span>  ],</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">2.</span>  , <span class="fl">1.</span>  ],</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">2.25</span>, <span class="fl">1.</span>  ],</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">2.5</span> , <span class="fl">1.</span>  ],</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">2.75</span>, <span class="fl">1.</span>  ],</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">3.</span>  , <span class="fl">1.</span>  ],</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">3.25</span>, <span class="fl">1.</span>  ],</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">3.5</span> , <span class="fl">1.</span>  ],</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">3.75</span>, <span class="fl">1.</span>  ],</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">4.</span>  , <span class="fl">1.</span>  ],</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">4.25</span>, <span class="fl">1.</span>  ],</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">4.5</span> , <span class="fl">1.</span>  ],</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">4.75</span>, <span class="fl">1.</span>  ],</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">5.</span>  , <span class="fl">1.</span>  ],</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">5.25</span>, <span class="fl">1.</span>  ],</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">5.5</span> , <span class="fl">1.</span>  ],</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">5.75</span>, <span class="fl">1.</span>  ],</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">6.</span>  , <span class="fl">1.</span>  ],</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">6.25</span>, <span class="fl">1.</span>  ],</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">6.5</span> , <span class="fl">1.</span>  ],</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">6.75</span>, <span class="fl">1.</span>  ],</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">7.</span>  , <span class="fl">1.</span>  ],</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">7.25</span>, <span class="fl">1.</span>  ],</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">7.5</span> , <span class="fl">1.</span>  ]])</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> np.array([<span class="fl">9.8</span> <span class="op">*</span> t<span class="op">**</span><span class="dv">2</span> <span class="op">/</span><span class="dv">2</span> <span class="op">+</span> height_estimates[t] <span class="cf">for</span> t <span class="kw">in</span> height_estimates.keys()])</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>z</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>array([<span class="fl">199.6</span>    , <span class="fl">203.26625</span>, <span class="fl">208.455</span>  , <span class="fl">211.04625</span>, <span class="fl">212.37</span>   , <span class="fl">211.61625</span>,</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>       <span class="fl">210.205</span>  , <span class="fl">217.91625</span>, <span class="fl">223.89</span>   , <span class="fl">221.11625</span>, <span class="fl">226.335</span>  , <span class="fl">224.94625</span>,</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>       <span class="fl">231.71</span>   , <span class="fl">228.87625</span>, <span class="fl">231.095</span>  , <span class="fl">240.79625</span>, <span class="fl">237.08</span>   , <span class="fl">241.14625</span>,</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>       <span class="fl">245.925</span>  , <span class="fl">249.07625</span>, <span class="fl">249.77</span>   , <span class="fl">257.43625</span>, <span class="fl">252.195</span>  , <span class="fl">258.91625</span>,</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>       <span class="fl">259.48</span>   , <span class="fl">258.74625</span>, <span class="fl">262.775</span>  , <span class="fl">268.67625</span>, <span class="fl">265.43</span>   , <span class="fl">272.22625</span>,</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>       <span class="fl">274.175</span>  ])	  </span></code></pre></div>
<p>Now we can solve the least-squares problem:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>sol2 <span class="op">=</span> la.lstsq(N,z,rcond<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>sol2</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>(array([  <span class="fl">9.70395161</span>, <span class="fl">200.90997984</span>]),</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a> array([<span class="fl">197.84468931</span>]),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a> array([<span class="fl">24.78130767</span>,  <span class="fl">2.79719328</span>]))</span></code></pre></div>
<p>Now we get coefficients <span class="math inline">\(\beta_1,\delta_1\)</span> via</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>beta1,delta1 <span class="op">=</span> sol2[<span class="dv">0</span>]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Q(x) = </span><span class="sc">{</span><span class="op">-</span><span class="fl">9.8</span><span class="op">/</span><span class="dv">2</span><span class="sc">:.03f}</span><span class="ss">*t^2 + </span><span class="sc">{</span>beta1<span class="sc">:.03f}</span><span class="ss">*t + </span><span class="sc">{</span>delta1<span class="sc">:.03f}</span><span class="ss">&quot;</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>Q(x) <span class="op">=</span> <span class="op">-</span><span class="fl">4.900</span><span class="op">*</span>t<span class="op">^</span><span class="dv">2</span> <span class="op">+</span> <span class="fl">9.704</span><span class="op">*</span>t <span class="op">+</span> <span class="fl">200.910</span></span></code></pre></div>
<p>With this assumption, our estimate for the initial velocity is</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>beta1</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fl">9.703951612903246</span></span></code></pre></div>
<p>which is a little faster than our earlier estimate, and</p>
<p>our estimate for the initial height is</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>delta1</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fl">200.90997983870963</span></span></code></pre></div>
<p>which is not quite as high as our earlier estimate.</p>
</div></li>
<li><p>Produce via <code>matplotlib</code> a graph of the function <code>f</code> you obtained
as the best-fit in c., superimposed on the data plot above.
(You can use the code from the lecture notebook).</p>
<div class="solution">
<p>We first define the function determined by our least-squares solutions above:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Qnew(t):</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>   <span class="cf">return</span> (<span class="op">-</span><span class="fl">9.8</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>t<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> beta1<span class="op">*</span>t <span class="op">+</span> delta1</span></code></pre></div>
<p>Now we produce the plot as before:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>plot_curve_fit(x,Qnew,x,y)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span></code></pre></div>
<p><img src="../course-assets/images/ps09-image-02.png" /></p>
<p>(The resulting graph is not substantially different than the previous one…)</p>
</div></li>
</ol></li>
</ol>
        </main>

        <footer>
	  <nav>
	    <a href="http://www.tufts.edu">
	      <i class="fas fa-chalkboard"></i>
	      Tufts
	    </a>	    
	    <a href="http://math.tufts.edu">
	      <i class="fas fa-chalkboard-teacher"></i>
	      Tufts Math
	    </a>
	    <a href="https://gmcninch-tufts.github.io/math">
	      <i class="fas fa-coffee"></i>
	      G McNinch
	    </a>
	    <a href="https://github.com/gmcninch-tufts">
	      <i class="fab fa-github"></i>
	      GitHub
	    </a>	    
	  </nav>
        </footer>
    </body>
</html>
