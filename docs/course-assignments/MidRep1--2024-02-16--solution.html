<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Math87-Tufts University - Midterm Project 1 -- Supply chain *solutions*</title>
	<script>
	  window.MathJax = {
	    options: {
	      ignoreHtmlClass: 'tex2jax_ignore',
	      processHtmlClass: 'tex2jax_process'
	    },
	    tex: {
	      autoload: {
		color: [],
		colorv2: ['color']
	      },
	      packages: {'[+]': ['noerrors']}
	    },
	    loader: {
	      load: ['input/asciimath', '[tex]/noerrors']
	    }
	  };
	</script>
	<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>
        <link rel="stylesheet" href="../css/default.css" />
	<link rel="stylesheet" href="../css/haddock.css" />
	
	<link href="https://fonts.googleapis.com/css?family=Lato:400,700" type="text/css" rel="stylesheet" media="screen" />
	<link href="https://fonts.googleapis.com/css?family=Arimo:400,700" type="text/css" rel="stylesheet" media="screen" />
	<link href="https://fonts.googleapis.com/css?family=Roboto:400,700" type="text/css" rel="stylesheet" media="screen" />
	<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700" type="text/css" rel="stylesheet" media="screen" />
	<link href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" type="text/css" rel="stylesheet" media="screen" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous" />			
    </head>
    <body>
        <header>
          <div class="logo">
            <a href="../">
	      Math87 - Spring 2024 - Tufts Univ</a>
          </div>
          <nav>
            <a href="../about.html">About</a>
	    <a href="../course-pages/Math087--course-info.html">Info</a>	    
            <a href="../archive.html">Archive</a>
          </nav>
        </header>

        <main role="main">
            <h1>Midterm Project 1 -- Supply chain *solutions*</h1>
            <p>(You can get a full <a href="../course-assets/code/midterm-report-1.py">copy of the code</a> I use for the solution here.</p>
<h1 id="description-of-the-network-flow">Description of the network flow</h1>
<p>As the logistics manager for the rubber ducks company, we are first
tasked with minimizing shipping costs for the duck supply chain.</p>
<p>We create a <em>network flow</em> to represent the distribution of ducks.
The <em>nodes</em> of our Network flow are the <code>warehouse_cities</code> and the
<code>store_cities</code>, together with a node representing the <code>source</code> of
ducks and a node representing <code>demand</code> for ducks.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> linprog</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>warehouse_cities <span class="op">=</span> [ <span class="st">'Santa Fe'</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'El Paso'</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'Tampa Bay'</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                    ]</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>store_cities <span class="op">=</span> [ <span class="st">'Chicago'</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'LA'</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'NY'</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'Houston'</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'Atlanta'</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>vertices<span class="op">=</span>[ <span class="st">'Source'</span>,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>           <span class="op">*</span>warehouse_cities,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>           <span class="op">*</span>store_cities,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>           <span class="st">'Demand'</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>          ]</span></code></pre></div>
<p>To formulate our <em>network flow</em>, we are going to describe edges
between nodes. Ultimately, we describe a <em>linear program</em> using the
network flow; the <em>variables</em> of the linear program correspond to the
<em>edges</em> of our network flow. And the numerical quantities assigned to
these variables represent <em>ducks</em>; in the case of an edge connecting
city-nodes, the variable represents the quantity of ducks
transported. In the case of an edge connecting the <code>source</code> node to a
<code>warehouse_city</code>, the variable represents the <em>production</em> of ducks,
and in the case of an edge connecting a <code>store city</code> to the <code>Demand</code> node, the
variable represents the quantity of ducks <em>sold</em>.</p>
<p>We create an edge between <code>Source</code>
and each <code>warehouse_city</code>, and between each <code>store_city</code> and <code>Demand</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>edges_source <span class="op">=</span> [ { <span class="st">'from'</span>: <span class="st">'Source'</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'to'</span>: c,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                   }</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> c <span class="kw">in</span> warehouse_cities ]</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>edges_demand <span class="op">=</span> [ { <span class="st">'from'</span>: c,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'to'</span>: <span class="st">'Demand'</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                   }</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">for</span> c <span class="kw">in</span> store_cities</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>				</span></code></pre></div>
<p>Now, we only create an edge between shipping when indicated.</p>
<p>Recall our shipping and relay costs:</p>
<table>
<caption>Shipping costs ($ per <code>duck</code>)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Chicago</th>
<th style="text-align: left;">LA</th>
<th style="text-align: left;">NY</th>
<th style="text-align: left;">Houston</th>
<th style="text-align: left;">Atlanta</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Santa Fe</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">El Paso</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tampa Bay</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">4</td>
</tr>
</tbody>
</table>
<table>
<caption>Relay route costs ($ per duck)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Chicago</th>
<th style="text-align: left;">LA</th>
<th style="text-align: left;">NY</th>
<th style="text-align: left;">Houston</th>
<th style="text-align: left;">Atlanta</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Houston</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Atlanta</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">-</td>
</tr>
</tbody>
</table>
<p>We create functions in python representing these costs, as follows:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ship_costs(f,t):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    match (f,t):</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Source'</span>,_:             <span class="co"># no shipping cost for &quot;shipments&quot; from source to warehouse</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> _,<span class="st">'Demand'</span>:             <span class="co"># no shipping costs for &quot;shipments&quot; from store to customers</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Santa Fe'</span>,<span class="st">'Chicago'</span>:</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">6</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Santa Fe'</span>,<span class="st">'LA'</span>:</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">3</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Santa Fe'</span>,<span class="st">'Houston'</span>:</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">3</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Santa Fe'</span>,<span class="st">'Atlanta'</span>:</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">7</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'El Paso'</span>,<span class="st">'LA'</span>:</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">7</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'El Paso'</span>,<span class="st">'Houston'</span>:</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">2</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'El Paso'</span>,<span class="st">'Atlanta'</span>:</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">5</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Tampa Bay'</span>,<span class="st">'NY'</span>:</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">7</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Tampa Bay'</span>,<span class="st">'Houston'</span>:</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">6</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Tampa Bay'</span>,<span class="st">'Atlanta'</span>:</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">4</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> _:</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> inf</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> relay_costs(f,t):</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    match (f,t):</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Houston'</span>,<span class="st">'Chicago'</span>:</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">4</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Houston'</span>,<span class="st">'LA'</span>:</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">5</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Houston'</span>,<span class="st">'NY'</span>:</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">6</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Houston'</span>,<span class="st">'Atlanta'</span>:</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">2</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Atlanta'</span>,<span class="st">'Chicago'</span>:</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">4</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Atlanta'</span>,<span class="st">'NY'</span>:</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">5</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Atlanta'</span>,<span class="st">'Houston'</span>:</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">2</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> _:</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> inf</span></code></pre></div>
<p>Now we can create the remaining edges for our network flow.
We only create an edge if the shipping costs are given above.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>edges_ship <span class="op">=</span> [ { <span class="st">'from'</span>: source,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'to'</span>: dest,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>               <span class="cf">for</span> source,dest <span class="kw">in</span> product(warehouse_cities,store_cities)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>               <span class="cf">if</span> ship_costs(source,dest) <span class="op">!=</span> inf</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>              ]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>edges_relay <span class="op">=</span> [ { <span class="st">'from'</span>: source,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'to'</span>: dest,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                 }</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> source,dest <span class="kw">in</span> product(store_cities,store_cities)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> relay_costs(source,dest) <span class="op">!=</span> inf</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>               ]</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># we now get all the edges by concatenation of preceding lists</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>edges <span class="op">=</span>  edges_source <span class="op">+</span> edges_ship <span class="op">+</span> edges_relay <span class="op">+</span> edges_demand </span></code></pre></div>
<p>And we can use the <code>vertices</code> and <code>edges</code> to produce a diagram of the network
flow, using <code>graphviz</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------------------------------------------------------------</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> graphviz <span class="im">import</span> Digraph <span class="im">as</span> GVDigraph</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>dot <span class="op">=</span> GVDigraph(<span class="st">&quot;example&quot;</span>,<span class="bu">format</span><span class="op">=</span><span class="st">'png'</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>dot.attr(rankdir<span class="op">=</span><span class="st">'LR'</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>dot.node(<span class="st">'Source'</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> dot.subgraph(name<span class="op">=</span><span class="st">'warehouse'</span>) <span class="im">as</span> c:</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    c.attr(rank<span class="op">=</span><span class="st">'same'</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> vertex <span class="kw">in</span> warehouse_cities:</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        c.node(vertex)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> dot.subgraph(name<span class="op">=</span><span class="st">'hubs'</span>) <span class="im">as</span> c:</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    c.attr(rank<span class="op">=</span><span class="st">'same'</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> vertex <span class="kw">in</span> hubs:</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        c.node(vertex)            </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> dot.subgraph(name<span class="op">=</span><span class="st">'stores'</span>) <span class="im">as</span> c:</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    c.attr(rank<span class="op">=</span><span class="st">'same'</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> vertex <span class="kw">in</span> store_cities:</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> (vertex <span class="kw">in</span> hubs):</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>            c.node(vertex)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>c.node(<span class="st">'Demand'</span>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co"># make an edge in the graph for each of our edges.</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> e <span class="kw">in</span> edges:</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="co">#  dot.edge(e[&quot;from&quot;],e[&quot;to&quot;],label=f&quot;costs {e['ship_costs']}&quot;)</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>  dot.edge(e[<span class="st">&quot;from&quot;</span>],e[<span class="st">&quot;to&quot;</span>])    </span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>dot.render(<span class="st">'graph.png'</span>)</span></code></pre></div>
<p>Here is the resulting network flow diagram. (We’ve chosen <em>not</em> to
label it, since the labels can get a bit cluttered. We’ll describe in
words the constraints on the edge variables, below).</p>
<p><img src="../course-assets/images/graph.png" /></p>
<h1 id="the-objective-function-for-shipping-costs">The objective function for shipping costs</h1>
<p>Our next task is to identify the <code>objective function</code> for the linear
program that we will use to minimize shipping costs.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># return a standard basis vector</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># these are &quot;0-indexed&quot; e.g. sbv(0,3) == [1,0,0]</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sbv(index,size):</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([<span class="fl">1.0</span> <span class="cf">if</span> i <span class="op">==</span> index <span class="cf">else</span> <span class="fl">0.0</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(size)])</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># we first create the vector for the costs for shipments from warehouse cities to store cities</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>ship_costs_obj <span class="op">=</span> <span class="bu">sum</span>([ ship_costs(e[<span class="st">'from'</span>],e[<span class="st">'to'</span>])<span class="op">*</span>sbv(edges.index(e),<span class="bu">len</span>(edges))</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                       <span class="cf">for</span> e <span class="kw">in</span> edges_ship])</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>ship_costs_obj</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>array([<span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">6.</span>, <span class="fl">3.</span>, <span class="fl">3.</span>, <span class="fl">7.</span>, <span class="fl">7.</span>, <span class="fl">2.</span>, <span class="fl">5.</span>, <span class="fl">7.</span>, <span class="fl">6.</span>, <span class="fl">4.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>       <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>])</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># we then create the vector for the relay costs</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>relay_costs_obj <span class="op">=</span> <span class="bu">sum</span>([ relay_costs(e[<span class="st">'from'</span>],e[<span class="st">'to'</span>])<span class="op">*</span>sbv(edges.index(e),<span class="bu">len</span>(edges))</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> e <span class="kw">in</span> edges_relay])</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>relay_costs_obj</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span> </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>array([<span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">4.</span>, <span class="fl">5.</span>, <span class="fl">6.</span>, <span class="fl">2.</span>,</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>       <span class="fl">4.</span>, <span class="fl">5.</span>, <span class="fl">2.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>])</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co"># the objective function is then the vector sum of the previous two results</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>costs_obj <span class="op">=</span> ship_costs_obj <span class="op">+</span> relay_costs_obj</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>costs_obj</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>array([<span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">6.</span>, <span class="fl">3.</span>, <span class="fl">3.</span>, <span class="fl">7.</span>, <span class="fl">7.</span>, <span class="fl">2.</span>, <span class="fl">5.</span>, <span class="fl">7.</span>, <span class="fl">6.</span>, <span class="fl">4.</span>, <span class="fl">4.</span>, <span class="fl">5.</span>, <span class="fl">6.</span>, <span class="fl">2.</span>,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>       <span class="fl">4.</span>, <span class="fl">5.</span>, <span class="fl">2.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>])</span></code></pre></div>
<h1 id="conservation-laws">Conservation laws</h1>
<p>Now we are going to identify the <em>conservation laws</em> for our network
flow. For each interior vertex of our diagram, we need that the sum
of the <em>incoming flow</em> is equal to the sum of the <em>outgoing flow</em>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> getIncoming(vertex,edges):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [ e <span class="cf">for</span> e <span class="kw">in</span> edges <span class="cf">if</span> e[<span class="st">&quot;to&quot;</span>] <span class="op">==</span> vertex ]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> getOutgoing(vertex,edges):</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [ e <span class="cf">for</span> e <span class="kw">in</span> edges <span class="cf">if</span> e[<span class="st">&quot;from&quot;</span>] <span class="op">==</span> vertex ] </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> isSource(vertex,edges):</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> getIncoming(vertex,edges) <span class="op">==</span> []</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> isSink(vertex,edges):</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> getOutgoing(vertex,edges) <span class="op">==</span> []</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> interiorVertices(vertices,edges):</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [ v <span class="cf">for</span> v <span class="kw">in</span> vertices <span class="cf">if</span> <span class="kw">not</span>( isSource(v,edges) <span class="kw">or</span> isSink(v,edges) ) ]</span></code></pre></div>
<p>Observe that this code indeed finds our interior vertices:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>interiorVertices(vertices,edges)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>[<span class="st">'Santa Fe'</span>, <span class="st">'El Paso'</span>, <span class="st">'Tampa Bay'</span>, <span class="st">'Chicago'</span>, <span class="st">'LA'</span>, <span class="st">'NY'</span>, <span class="st">'Houston'</span>, <span class="st">'Atlanta'</span>]</span></code></pre></div>
<p>Now we can create the <em>conservation laws matrix</em> for our network flow.
This matrix has one row for each interior vertex of the network flow;
this row expresses the relation that the sum of flow through edges
<em>to</em> the vertex is equal to the sum of flow through edges <em>from</em> the
vertex.</p>
<p>We use the following code:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> conservationLaw(vertex,edges):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    ii <span class="op">=</span> <span class="bu">sum</span>([ sbv(edges.index(e),<span class="bu">len</span>(edges)) <span class="cf">for</span> e <span class="kw">in</span> getIncoming(vertex,edges) ])</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    oo <span class="op">=</span> <span class="bu">sum</span>([ sbv(edges.index(e),<span class="bu">len</span>(edges)) <span class="cf">for</span> e <span class="kw">in</span> getOutgoing(vertex,edges) ])</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ii <span class="op">-</span> oo</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>conservationMatrix <span class="op">=</span>np.array([conservationLaw(v,edges) <span class="cf">for</span> v <span class="kw">in</span> interiorVertices(vertices,edges) ])</span></code></pre></div>
<p>And we can inspect this matrix:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>conservationMatrix</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>array([[ <span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>, <span class="op">-</span><span class="fl">1.</span>, <span class="op">-</span><span class="fl">1.</span>, <span class="op">-</span><span class="fl">1.</span>, <span class="op">-</span><span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>         <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>],</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.</span>,  <span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>, <span class="op">-</span><span class="fl">1.</span>, <span class="op">-</span><span class="fl">1.</span>, <span class="op">-</span><span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>         <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>],</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>, <span class="op">-</span><span class="fl">1.</span>, <span class="op">-</span><span class="fl">1.</span>, <span class="op">-</span><span class="fl">1.</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>         <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>],</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>         <span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>, <span class="op">-</span><span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>],</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>         <span class="fl">0.</span>,  <span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>, <span class="op">-</span><span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>],</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>         <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>, <span class="op">-</span><span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>],</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">1.</span>,  <span class="fl">0.</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">-</span><span class="fl">1.</span>, <span class="op">-</span><span class="fl">1.</span>, <span class="op">-</span><span class="fl">1.</span>, <span class="op">-</span><span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>, <span class="op">-</span><span class="fl">1.</span>,  <span class="fl">0.</span>],</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">1.</span>,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>         <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">1.</span>, <span class="op">-</span><span class="fl">1.</span>, <span class="op">-</span><span class="fl">1.</span>, <span class="op">-</span><span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>, <span class="op">-</span><span class="fl">1.</span>]])</span></code></pre></div>
<p>The conservation matrix will be used to implement the the linear
program we will use to minimize shipping costs; it will appear as part
of the <em>equality constraints</em>.</p>
<h1 id="setting-up-the-linear-program">Setting up the linear program</h1>
<p>We have already described the <em>objective function</em>. It remains to describe
the equality- and inequality- constraints that we will use.</p>
<h2 id="equality-constraints">Equality constraints</h2>
<p>When minimizing the shipping costs, we ship all available ducks from
the warehouses, and we meet demand in the store cities. Thus, we
implement the <code>supply</code> and <code>demand</code> as <em>equality constraints</em> in our
linear program.</p>
<p>Recall the supply and demand specifications:</p>
<table>
<caption>Supplies (in <code>ducks</code>)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Santa Fe</th>
<th style="text-align: left;">El Paso</th>
<th style="text-align: left;">Tampa Bay</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">700</td>
<td style="text-align: left;">200</td>
<td style="text-align: left;">200</td>
</tr>
</tbody>
</table>
<table>
<caption>Demand (in <code>ducks</code>)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Chicago</th>
<th style="text-align: left;">LA</th>
<th style="text-align: left;">NY</th>
<th style="text-align: left;">Houston</th>
<th style="text-align: left;">Atlanta</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">200</td>
<td style="text-align: left;">200</td>
<td style="text-align: left;">250</td>
<td style="text-align: left;">300</td>
<td style="text-align: left;">150</td>
</tr>
</tbody>
</table>
<p>We implement these with the following code:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>supplies <span class="op">=</span> { <span class="st">'Santa Fe'</span>: <span class="dv">700</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">'El Paso'</span>: <span class="dv">200</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">'Tampa Bay'</span>: <span class="dv">200</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>             }</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>demand <span class="op">=</span> { <span class="st">'Chicago'</span>: <span class="dv">200</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>           <span class="st">'LA'</span>: <span class="dv">200</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>           <span class="st">'NY'</span>: <span class="dv">250</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>           <span class="st">'Houston'</span>: <span class="dv">300</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>           <span class="st">'Atlanta'</span>: <span class="dv">150</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<p>More precisely, for each warehouse city <code>w</code>, the
variable corresponding to edge <code>{'from':'Source','to':w}</code> is equated with
the quantity <code>supplies[w]</code>.</p>
<p>Similarly, for each store city <code>w</code>, the variable
corresponding to the edge <code>{'from':w,'to':'Demand'}</code> is equated with the
quantity <code>demand[s]</code>.</p>
<p>We create the pair
<code>Aeq_costs,beq_costs</code> determining the equality constraints using the following code:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># return the edge with 'from': f and 'to': t</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lookupEdge(f,t):</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> <span class="bu">list</span>(<span class="bu">filter</span>(<span class="kw">lambda</span> x: x[<span class="st">'from'</span>] <span class="op">==</span> f <span class="kw">and</span> x[<span class="st">'to'</span>] <span class="op">==</span> t, edges))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> r <span class="op">!=</span> []:</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> r[<span class="dv">0</span>]</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;error&quot;</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># get the *index* (in our list of edges) of the edge with 'from': f and 'to': t</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lookupEdgeIndex(f,t):</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> lookupEdge(f,t)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> edges.index(r)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>Aeq_costs <span class="op">=</span> np.concatenate([ conservationMatrix,</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>                             [ sbv(lookupEdgeIndex(<span class="st">'Source'</span>,w),<span class="bu">len</span>(edges))</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>                               <span class="cf">for</span> w <span class="kw">in</span> warehouse_cities ],</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>                             [ sbv(lookupEdgeIndex(s,<span class="st">'Demand'</span>),<span class="bu">len</span>(edges))</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>                               <span class="cf">for</span> s <span class="kw">in</span> store_cities ]</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>                            ],axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>beq_costs <span class="op">=</span> np.concatenate([ np.zeros(<span class="bu">len</span>(conservationMatrix)),</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>                             [ supplies[w] <span class="cf">for</span> w <span class="kw">in</span> warehouse_cities ],</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>                             [ demand[s] <span class="cf">for</span> s <span class="kw">in</span> store_cities ]</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>                            ])</span></code></pre></div>
<p>Thus the first rows of <code>Aeq_costs</code> are the <code>conservationMatrix</code> computer earlier.
The next group of rows account for edges <code>Source -&gt; warehouse_cities</code>,
and the final group of rows account for edges <code>store_cities -&gt; Demand</code>.</p>
<p>When running the linear program, the equality constraint
<code>Aeq_costs,beq_costs</code> will thus enforce the conservation laws, require
that we ship all available ducks, and require that we meet all demand.</p>
<h2 id="inequality-constraints">Inequality constraints</h2>
<p>Finally, we need to create inequality constraints reflecting the condition
that we can’t ship more than 200 ducks along any single route.</p>
<p>The pair <code>Aub_costs,bub_costs</code> implement these constraints; these
quantities are created by the following code:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create inequality constraint matrix</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># initially the only thing to account for is &quot;can't ship more than 200 ducks&quot;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>Aub_costs <span class="op">=</span> np.array([ sbv(edges.index(e),<span class="bu">len</span>(edges)) <span class="cf">for</span> e <span class="kw">in</span> edges_ship ]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                     <span class="op">+</span> [ sbv(edges.index(e),<span class="bu">len</span>(edges)) <span class="cf">for</span> e <span class="kw">in</span> edges_relay ])</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>bub_costs <span class="op">=</span> np.array([ <span class="dv">200</span> <span class="cf">for</span> e <span class="kw">in</span> edges_ship]</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                     <span class="op">+</span> [ <span class="dv">200</span> <span class="cf">for</span> e <span class="kw">in</span> edges_relay ] )</span></code></pre></div>
<h2 id="running-the-linear-program.">Running the linear program.</h2>
<p>We are now ready to run the linear program which minimizes shipping costs.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>costs_result <span class="op">=</span> linprog(costs_obj,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                       A_eq <span class="op">=</span> Aeq_costs,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                       b_eq <span class="op">=</span> beq_costs,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                       A_ub <span class="op">=</span> Aub_costs,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                       b_ub <span class="op">=</span> bub_costs</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                       )</span></code></pre></div>
<p>We see that the minimal shipping costs are $5,300.00:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>costs_result.fun</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fl">5300.0</span></span></code></pre></div>
<p>And we can see the required shipping levels by inspecting <code>costs_result.x</code>.
Let’s view a report of this information:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> report(x):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (val,e) <span class="kw">in</span> <span class="bu">zip</span>(x,edges):</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>e[<span class="st">'from'</span>]<span class="sc">:10}</span><span class="ss"> -&gt; </span><span class="sc">{</span>e[<span class="st">'to'</span>]<span class="sc">:10}</span><span class="ss">:  </span><span class="sc">{</span>val<span class="sc">: 7.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>		</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>report(costs_result.x)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>Source     <span class="op">-&gt;</span> Santa Fe  :   <span class="fl">700.00</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>Source     <span class="op">-&gt;</span> El Paso   :   <span class="fl">200.00</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>Source     <span class="op">-&gt;</span> Tampa Bay :   <span class="fl">200.00</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> Chicago   :   <span class="fl">200.00</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> LA        :   <span class="fl">200.00</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> Houston   :   <span class="fl">200.00</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> Atlanta   :   <span class="fl">100.00</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>El Paso    <span class="op">-&gt;</span> LA        :     <span class="fl">0.00</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>El Paso    <span class="op">-&gt;</span> Houston   :   <span class="fl">200.00</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>El Paso    <span class="op">-&gt;</span> Atlanta   :    <span class="op">-</span><span class="fl">0.00</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>Tampa Bay  <span class="op">-&gt;</span> NY        :   <span class="fl">200.00</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>Tampa Bay  <span class="op">-&gt;</span> Houston   :     <span class="fl">0.00</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>Tampa Bay  <span class="op">-&gt;</span> Atlanta   :     <span class="fl">0.00</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> Chicago   :     <span class="fl">0.00</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> LA        :     <span class="fl">0.00</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> NY        :    <span class="fl">50.00</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> Atlanta   :    <span class="fl">50.00</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> Chicago   :     <span class="fl">0.00</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> NY        :     <span class="fl">0.00</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> Houston   :     <span class="fl">0.00</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>Chicago    <span class="op">-&gt;</span> Demand    :   <span class="fl">200.00</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>LA         <span class="op">-&gt;</span> Demand    :   <span class="fl">200.00</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>NY         <span class="op">-&gt;</span> Demand    :   <span class="fl">250.00</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> Demand    :   <span class="fl">300.00</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> Demand    :   <span class="fl">150.00</span></span></code></pre></div>
<h1 id="los-angeles-potential-strike-scenario">Los Angeles potential strike scenario</h1>
<p>We must deal with restive workers in LA. We consider two outcomes:
how are costs affected if we <em>meet workers demands</em> and if <em>the workers go on strike</em>?</p>
<h2 id="demand-scenario">Demand scenario</h2>
<p>The workers demand would result in the doubling of all shipping costs to LA.</p>
<p>Using the following code, we can model the “demand scenario” shipping costs:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> LA_demand_ship_costs(f,t):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    match (f,t):</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>        case (_,<span class="st">'LA'</span>):</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>ship_costs(f,t)      <span class="co">## double shipping costs to LA</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> _:</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> ship_costs(f,t)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> LA_demand_relay_costs(f,t):</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    match (f,t):</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>        case (_,<span class="st">'LA'</span>):</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>relay_costs(f,t)      <span class="co">## double shipping costs to LA</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> _:</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> relay_costs(f,t)</span></code></pre></div>
<p>These changes modify the require <em>objective function</em> for the linear program
which will tell us the impact of the demand-scenario on our shipping costs.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>LA_demand_ship_costs_obj <span class="op">=</span> <span class="bu">sum</span>([ LA_demand_ship_costs(e[<span class="st">'from'</span>],e[<span class="st">'to'</span>])<span class="op">*</span>sbv(edges.index(e),<span class="bu">len</span>(edges))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                       <span class="cf">for</span> e <span class="kw">in</span> edges_ship])</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>LA_demand_relay_costs_obj <span class="op">=</span> <span class="bu">sum</span>([ relay_costs(e[<span class="st">'from'</span>],e[<span class="st">'to'</span>])<span class="op">*</span>sbv(edges.index(e),<span class="bu">len</span>(edges))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> e <span class="kw">in</span> edges_relay])</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>LA_demand_costs_obj <span class="op">=</span> LA_demand_ship_costs_obj <span class="op">+</span> LA_demand_relay_costs_obj</span></code></pre></div>
<p>With the updated objective function, we can now run the linear program:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>LA_demand_costs_result <span class="op">=</span> linprog(LA_demand_costs_obj,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                                 A_eq <span class="op">=</span> Aeq_costs,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                                 b_eq <span class="op">=</span> beq_costs,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                                 A_ub <span class="op">=</span> Aub_costs,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                                 b_ub <span class="op">=</span> bub_costs</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                                 )</span></code></pre></div>
<p>We can see the outcome:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>LA_demand_costs_result.fun</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fl">5900.0</span></span></code></pre></div>
<p>And we can see the details of how our shipping choices will be affected.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>report(LA_demand_costs_result.x)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>Source     <span class="op">-&gt;</span> Santa Fe  :   <span class="fl">700.00</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>Source     <span class="op">-&gt;</span> El Paso   :   <span class="fl">200.00</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>Source     <span class="op">-&gt;</span> Tampa Bay :   <span class="fl">200.00</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> Chicago   :   <span class="fl">200.00</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> LA        :   <span class="fl">200.00</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> Houston   :   <span class="fl">200.00</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> Atlanta   :   <span class="fl">100.00</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>El Paso    <span class="op">-&gt;</span> LA        :     <span class="fl">0.00</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>El Paso    <span class="op">-&gt;</span> Houston   :   <span class="fl">200.00</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>El Paso    <span class="op">-&gt;</span> Atlanta   :    <span class="op">-</span><span class="fl">0.00</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>Tampa Bay  <span class="op">-&gt;</span> NY        :   <span class="fl">200.00</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>Tampa Bay  <span class="op">-&gt;</span> Houston   :     <span class="fl">0.00</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>Tampa Bay  <span class="op">-&gt;</span> Atlanta   :     <span class="fl">0.00</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> Chicago   :     <span class="fl">0.00</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> LA        :     <span class="fl">0.00</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> NY        :    <span class="fl">50.00</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> Atlanta   :    <span class="fl">50.00</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> Chicago   :     <span class="fl">0.00</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> NY        :     <span class="fl">0.00</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> Houston   :     <span class="fl">0.00</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>Chicago    <span class="op">-&gt;</span> Demand    :   <span class="fl">200.00</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>LA         <span class="op">-&gt;</span> Demand    :   <span class="fl">200.00</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>NY         <span class="op">-&gt;</span> Demand    :   <span class="fl">250.00</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> Demand    :   <span class="fl">300.00</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> Demand    :   <span class="fl">150.00</span></span></code></pre></div>
<p>Thus, our costs increase from $5300 to $5900 - an increase of
$600.</p>
<h2 id="strike-scenario">Strike scenario</h2>
<p>Now we must model the strike scenario for LA.
If workers demands are not met, they will strike and the maximum
number of supplies that can be shipped on <em>all routes to LA</em> is cut
in half (i.e., from 200 to 100).</p>
<p>Thus, the <em>inequality constraints</em> for the linear program must be modified.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">## the Aub matrix is the same as befofe</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>LA_strike_Aub_costs <span class="op">=</span> Aub_costs</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">## but we must change the bub vector</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># the capacity for a route is 100 on any route `to` LA.</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># otherwise the capacity remains 200</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> LA_strike_capacity(e):</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">match</span> e[<span class="st">'to'</span>]:</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'LA'</span>:</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">100</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> _:</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">200</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>LA_strike_bub_costs <span class="op">=</span> np.array([ LA_strike_capacity(e) <span class="cf">for</span> e <span class="kw">in</span> edges_ship]</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>                               <span class="op">+</span> [ LA_strike_capacity(e) <span class="cf">for</span> e <span class="kw">in</span> edges_relay ] )</span></code></pre></div>
<p>With the updated inequality constraints, we can run the linear program modeling a strike in LA:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>LA_strike_costs_result <span class="op">=</span> linprog(costs_obj,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                                 A_eq <span class="op">=</span> Aeq_costs,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                                 b_eq <span class="op">=</span> beq_costs,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                                 A_ub <span class="op">=</span> LA_strike_Aub_costs,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                                 b_ub <span class="op">=</span> LA_strike_bub_costs</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                                 )</span></code></pre></div>
<p>In the strike scenario, our costs go up to $6050.00. Indeed:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>LA_strike_costs_result.fun</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fl">6050.0</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>report(LA_strike_costs_result.x)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>Source     <span class="op">-&gt;</span> Santa Fe  :   <span class="fl">700.00</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>Source     <span class="op">-&gt;</span> El Paso   :   <span class="fl">200.00</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>Source     <span class="op">-&gt;</span> Tampa Bay :   <span class="fl">200.00</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> Chicago   :   <span class="fl">200.00</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> LA        :   <span class="fl">100.00</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> Houston   :   <span class="fl">200.00</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> Atlanta   :   <span class="fl">200.00</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>El Paso    <span class="op">-&gt;</span> LA        :     <span class="fl">0.00</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>El Paso    <span class="op">-&gt;</span> Houston   :   <span class="fl">200.00</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>El Paso    <span class="op">-&gt;</span> Atlanta   :     <span class="fl">0.00</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>Tampa Bay  <span class="op">-&gt;</span> NY        :   <span class="fl">200.00</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>Tampa Bay  <span class="op">-&gt;</span> Houston   :     <span class="fl">0.00</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>Tampa Bay  <span class="op">-&gt;</span> Atlanta   :     <span class="fl">0.00</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> Chicago   :     <span class="fl">0.00</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> LA        :   <span class="fl">100.00</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> NY        :     <span class="fl">0.00</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> Atlanta   :     <span class="fl">0.00</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> Chicago   :    <span class="op">-</span><span class="fl">0.00</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> NY        :    <span class="fl">50.00</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> Houston   :     <span class="fl">0.00</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>Chicago    <span class="op">-&gt;</span> Demand    :   <span class="fl">200.00</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>LA         <span class="op">-&gt;</span> Demand    :   <span class="fl">200.00</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>NY         <span class="op">-&gt;</span> Demand    :   <span class="fl">250.00</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> Demand    :   <span class="fl">300.00</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> Demand    :   <span class="fl">150.00</span></span></code></pre></div>
<h2 id="assessment-in-la">Assessment in LA</h2>
<p>Comparing the two LA scenarios,, the strike imposes $150 more shipping
costs – raising our costs to $6,050 – than the demand scenario –
which only raises our costs to $5,900.</p>
<p>So unless there are relevant issues not considered here, we should
probably agree to the LA workers demands.</p>
<h1 id="houston-potential-strike-scenario">Houston potential strike scenario</h1>
<p>We must now consider the same situation just contemplated in LA, but
for the city Houston.</p>
<h2 id="demand-scenario-1">Demand scenario</h2>
<p>Once again, we model the shipping costs and the relay costs with new
functions. This time, we double the shipping rate on routes <em>to</em> Houston:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Houston_demand_ship_costs(f,t):</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    match (f,t):</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>        case (_,<span class="st">'Houston'</span>):</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>ship_costs(f,t)      <span class="co">## double shipping costs to Houston</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> _:</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> ship_costs(f,t)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Houston_demand_relay_costs(f,t):</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    match (f,t):</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>        case (_,<span class="st">'Houston'</span>):</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>relay_costs(f,t)      <span class="co">## double shipping costs to Houston</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> _:</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> relay_costs(f,t)</span></code></pre></div>
<p>Using these new costs functions, we define the corresponding objective
vector, and run the linear program for the <em>Houston - demand
scenario</em>:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>Houston_demand_ship_costs_obj <span class="op">=</span> <span class="bu">sum</span>([ Houston_demand_ship_costs(e[<span class="st">'from'</span>],e[<span class="st">'to'</span>])<span class="op">*</span>sbv(edges.index(e),<span class="bu">len</span>(edges))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                       <span class="cf">for</span> e <span class="kw">in</span> edges_ship])</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>Houston_demand_relay_costs_obj <span class="op">=</span> <span class="bu">sum</span>([ relay_costs(e[<span class="st">'from'</span>],e[<span class="st">'to'</span>])<span class="op">*</span>sbv(edges.index(e),<span class="bu">len</span>(edges))</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> e <span class="kw">in</span> edges_relay])</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>Houston_demand_costs_obj <span class="op">=</span> Houston_demand_ship_costs_obj <span class="op">+</span> Houston_demand_relay_costs_obj</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># results</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>Houston_demand_costs_result <span class="op">=</span> linprog(Houston_demand_costs_obj,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>                                      A_eq <span class="op">=</span> Aeq_costs,</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>                                      b_eq <span class="op">=</span> beq_costs,</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>                                      A_ub <span class="op">=</span> Aub_costs,</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>                                      b_ub <span class="op">=</span> bub_costs</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>                                      )</span></code></pre></div>
<p>Under the demand scenario in Houston, our costs go up to $6250.00.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>Houston_demand_costs_result.fun</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fl">6250.0</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>report(Houston_demand_costs_result.x)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>Source     <span class="op">-&gt;</span> Santa Fe  :   <span class="fl">700.00</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>Source     <span class="op">-&gt;</span> El Paso   :   <span class="fl">200.00</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>Source     <span class="op">-&gt;</span> Tampa Bay :   <span class="fl">200.00</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> Chicago   :   <span class="fl">200.00</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> LA        :   <span class="fl">200.00</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> Houston   :   <span class="fl">100.00</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> Atlanta   :   <span class="fl">200.00</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>El Paso    <span class="op">-&gt;</span> LA        :     <span class="fl">0.00</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>El Paso    <span class="op">-&gt;</span> Houston   :   <span class="fl">200.00</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>El Paso    <span class="op">-&gt;</span> Atlanta   :    <span class="op">-</span><span class="fl">0.00</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>Tampa Bay  <span class="op">-&gt;</span> NY        :   <span class="fl">200.00</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>Tampa Bay  <span class="op">-&gt;</span> Houston   :     <span class="fl">0.00</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>Tampa Bay  <span class="op">-&gt;</span> Atlanta   :     <span class="fl">0.00</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> Chicago   :     <span class="fl">0.00</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> LA        :     <span class="fl">0.00</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> NY        :     <span class="fl">0.00</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> Atlanta   :     <span class="fl">0.00</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> Chicago   :     <span class="fl">0.00</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> NY        :    <span class="fl">50.00</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> Houston   :     <span class="fl">0.00</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>Chicago    <span class="op">-&gt;</span> Demand    :   <span class="fl">200.00</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>LA         <span class="op">-&gt;</span> Demand    :   <span class="fl">200.00</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>NY         <span class="op">-&gt;</span> Demand    :   <span class="fl">250.00</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> Demand    :   <span class="fl">300.00</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> Demand    :   <span class="fl">150.00</span></span></code></pre></div>
<h2 id="strike-scenario-1">Strike scenario</h2>
<p>We now model the consequences on our shipping costs of a strike in Houston.
As before, we have to modify the inequality constraints <code>Aub,bub</code>.
We do this in the same manner as we did for the LA situation, and we run the resulting
linear program.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>Houston_strike_Aub_costs <span class="op">=</span> Aub_costs</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> strike_capacity(e):</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">match</span> e[<span class="st">'to'</span>]:</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Houston'</span>:</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">100</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> _:</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">200</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>Houston_strike_bub_costs <span class="op">=</span> np.array([ strike_capacity(e) <span class="cf">for</span> e <span class="kw">in</span> edges_ship]</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                                   <span class="op">+</span> [ strike_capacity(e) <span class="cf">for</span> e <span class="kw">in</span> edges_relay ] )</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>Houston_strike_costs_result <span class="op">=</span> linprog(costs_obj,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>                                 A_eq <span class="op">=</span> Aeq_costs,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>                                 b_eq <span class="op">=</span> beq_costs,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>                                 A_ub <span class="op">=</span> Houston_strike_Aub_costs,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>                                 b_ub <span class="op">=</span> Houston_strike_bub_costs</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>                                 )</span></code></pre></div>
<p>The result shows that our shipping costs are $6050 in the event of a strike in Houston:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>Houston_strike_costs_result.fun</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fl">6050.0</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>report(Houston_strike_costs_result.x)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>Source     <span class="op">-&gt;</span> Santa Fe  :   <span class="fl">700.00</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>Source     <span class="op">-&gt;</span> El Paso   :   <span class="fl">200.00</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>Source     <span class="op">-&gt;</span> Tampa Bay :   <span class="fl">200.00</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> Chicago   :   <span class="fl">200.00</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> LA        :   <span class="fl">200.00</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> Houston   :   <span class="fl">100.00</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> Atlanta   :   <span class="fl">200.00</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>El Paso    <span class="op">-&gt;</span> LA        :    <span class="op">-</span><span class="fl">0.00</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>El Paso    <span class="op">-&gt;</span> Houston   :   <span class="fl">100.00</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>El Paso    <span class="op">-&gt;</span> Atlanta   :   <span class="fl">100.00</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>Tampa Bay  <span class="op">-&gt;</span> NY        :   <span class="fl">200.00</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>Tampa Bay  <span class="op">-&gt;</span> Houston   :     <span class="fl">0.00</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>Tampa Bay  <span class="op">-&gt;</span> Atlanta   :     <span class="fl">0.00</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> Chicago   :     <span class="fl">0.00</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> LA        :     <span class="fl">0.00</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> NY        :     <span class="fl">0.00</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> Atlanta   :     <span class="fl">0.00</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> Chicago   :    <span class="op">-</span><span class="fl">0.00</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> NY        :    <span class="fl">50.00</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> Houston   :   <span class="fl">100.00</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>Chicago    <span class="op">-&gt;</span> Demand    :   <span class="fl">200.00</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>LA         <span class="op">-&gt;</span> Demand    :   <span class="fl">200.00</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>NY         <span class="op">-&gt;</span> Demand    :   <span class="fl">250.00</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> Demand    :   <span class="fl">300.00</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> Demand    :   <span class="fl">150.00</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> </span></code></pre></div>
<h2 id="assessment-for-houston">Assessment for Houston</h2>
<p>In the case of Houston, the demand scenario raises costs to $6250,
while the strike scenario raises costs to $6050. Thus, meeting the
worker demands costs $200 more than allows the strike. Perhaps the
best strategy is to continue to negotiate with the Houston worker
rather than capitulate to the current demands.</p>
<h1 id="profit">Profit</h1>
<p>Finally, returning to the non-strike scenario, we consider also
the value of the ducks themselves.</p>
<p>The following table shows the impact on revenue at each city from
selling 1 rubber duck; in the warehouse cities, this impact measures
production costs (and hence is negative) while in store cities, the
impact measures sales revenue (and hence is positive):</p>
<table>
<caption>Profit by city (in $ per duck)</caption>
<colgroup>
<col style="width: 15%" />
<col style="width: 13%" />
<col style="width: 16%" />
<col style="width: 13%" />
<col style="width: 6%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Santa fe</th>
<th style="text-align: left;">El Paso</th>
<th style="text-align: left;">Tampa Bay</th>
<th style="text-align: left;">Chicago</th>
<th style="text-align: left;">NY</th>
<th style="text-align: left;">Houston</th>
<th style="text-align: left;">Atlanta</th>
<th style="text-align: left;">LA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">-8</td>
<td style="text-align: left;">-5</td>
<td style="text-align: left;">-10</td>
<td style="text-align: left;">15</td>
<td style="text-align: left;">25</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">20</td>
</tr>
</tbody>
</table>
<p>We are going to create a linear program that maximizes <em>total profit</em>,
taking into account revenue <em>and</em> shipping costs. Thus, we need to make a vector from the
profit quantities which will contribute to the required objective function.</p>
<p>We assign <em>revenue</em> to edges: edges of the form <code>Source -&gt; a</code> will be
assigned the revenue figure from the table for city <code>a</code>. And edges of the form <code>b -&gt; Demand</code>
will be assigned the revenue figure from the above table for city <code>b</code>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> revenue(e):</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">match</span> e[<span class="st">'from'</span>],e[<span class="st">'to'</span>]:</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Santa Fe'</span>,<span class="st">'Demand'</span>:</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">-</span><span class="dv">8</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'El Paso'</span>,<span class="st">'Demand'</span>:</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">-</span><span class="dv">5</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Tampa Bay'</span>,<span class="st">'Demand'</span>:</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">-</span><span class="dv">10</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Chicago'</span>,<span class="st">'Demand'</span>:</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">15</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'NY'</span>,<span class="st">'Demand'</span>:</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">25</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Houston'</span>,<span class="st">'Demand'</span>:</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">10</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'Atlanta'</span>,<span class="st">'Demand'</span>:</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">10</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">'LA'</span>,<span class="st">'Demand'</span>:</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">20</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> _:</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span></span></code></pre></div>
<p>In order to maximize profit, we need to create the appropriate
objective function.</p>
<p>We define a vector <code>sales</code> such that for a vector <code>x</code> of shipping values,
<code>sales · x</code> returns the revenue from sales of the corresponding ducks.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>sales <span class="op">=</span> np.array([ revenue(e) <span class="cf">for</span> e <span class="kw">in</span> edges])</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>sales</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>array([ <span class="op">-</span><span class="dv">8</span>,  <span class="op">-</span><span class="dv">5</span>, <span class="op">-</span><span class="dv">10</span>,   <span class="dv">0</span>,   <span class="dv">0</span>,   <span class="dv">0</span>,   <span class="dv">0</span>,   <span class="dv">0</span>,   <span class="dv">0</span>,   <span class="dv">0</span>,   <span class="dv">0</span>,   <span class="dv">0</span>,   <span class="dv">0</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>         <span class="dv">0</span>,   <span class="dv">0</span>,   <span class="dv">0</span>,   <span class="dv">0</span>,   <span class="dv">0</span>,   <span class="dv">0</span>,   <span class="dv">0</span>,  <span class="dv">15</span>,  <span class="dv">20</span>,  <span class="dv">25</span>,  <span class="dv">10</span>,  <span class="dv">10</span>])</span></code></pre></div>
<p>Now the objective function for the profit linear program is given by
<code>sales - costs-obj</code>, where <code>costs_obj</code> was the vector computing
the shipping costs (the objective function used when minimizing shipping costs).</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>profit_obj <span class="op">=</span> sales <span class="op">-</span> ship_costs_obj</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>probit_obj</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="op">=&gt;</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>array([ <span class="op">-</span><span class="fl">8.</span>,  <span class="op">-</span><span class="fl">5.</span>, <span class="op">-</span><span class="fl">10.</span>,  <span class="op">-</span><span class="fl">6.</span>,  <span class="op">-</span><span class="fl">3.</span>,  <span class="op">-</span><span class="fl">3.</span>,  <span class="op">-</span><span class="fl">7.</span>,  <span class="op">-</span><span class="fl">7.</span>,  <span class="op">-</span><span class="fl">2.</span>,  <span class="op">-</span><span class="fl">5.</span>,  <span class="op">-</span><span class="fl">7.</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">-</span><span class="fl">6.</span>,  <span class="op">-</span><span class="fl">4.</span>,   <span class="fl">0.</span>,   <span class="fl">0.</span>,   <span class="fl">0.</span>,   <span class="fl">0.</span>,   <span class="fl">0.</span>,   <span class="fl">0.</span>,   <span class="fl">0.</span>,  <span class="fl">15.</span>,  <span class="fl">20.</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>        <span class="fl">25.</span>,  <span class="fl">10.</span>,  <span class="fl">10.</span>])</span></code></pre></div>
<p>When maximizing profit, we no longer want to <em>require</em> that we
use all available supplies, and we don’t want to <em>require</em> that we meet
demand in each store.</p>
<p>Rather, we will view the <code>supplies</code> and <code>demand</code> quantities as <em>upper
bounds</em> for the values of the variables assigned respective to edges
of the form <code>Source -&gt; a</code> and <code>b -&gt; Demand</code> (for warehouse cites <code>a</code>
and store cities <code>b</code>).</p>
<p>In particular, the equality constraints for the profit linear
program are exactly the <em>conservation laws</em>:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>Aeq_profit <span class="op">=</span> conservationMatrix</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>beq_profit <span class="op">=</span> np.zeros(<span class="bu">len</span>(conservationMatrix))</span></code></pre></div>
<p>And the inequality constraints are as follows:</p>
<ul>
<li>variables corresponding to edges in <code>edges_ship</code> or <code>edges_relay</code> must be <code>&lt;= 200</code>.</li>
<li>variables corresponding to edges <code>Source -&gt; a</code> must be <code>&lt;= supply(a)</code>.</li>
<li>variables corresponding to edges <code>b -&gt; Demand</code> must be <code>&lt;= demand(b)</code>.</li>
</ul>
<p>In code, this yields the following definition for the pair
<code>Aub_profit,bub_profit</code>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>Aub_profit <span class="op">=</span> np.concatenate([ [ sbv(edges.index(e),<span class="bu">len</span>(edges)) <span class="cf">for</span> e <span class="kw">in</span> edges_ship ],</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                              [ sbv(edges.index(e),<span class="bu">len</span>(edges)) <span class="cf">for</span> e <span class="kw">in</span> edges_relay ],</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                              [ sbv(lookupEdgeIndex(<span class="st">'Source'</span>,w),<span class="bu">len</span>(edges))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">for</span> w <span class="kw">in</span> warehouse_cities ],                              </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                              [ sbv(lookupEdgeIndex(s,<span class="st">'Demand'</span>),<span class="bu">len</span>(edges))</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">for</span> s <span class="kw">in</span> store_cities]</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                              ]</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                            , axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>bub_profit <span class="op">=</span> np.concatenate([ [ <span class="dv">200</span> <span class="cf">for</span> e <span class="kw">in</span> edges_ship],</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>                              [ <span class="dv">200</span> <span class="cf">for</span> e <span class="kw">in</span> edges_relay ],</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>                              [ supplies[w] <span class="cf">for</span> w <span class="kw">in</span> warehouse_cities ],</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>                              [ demand[s] <span class="cf">for</span> s <span class="kw">in</span> store_cities ]</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>                             ])</span></code></pre></div>
<p>We now run the linear program maximizing profit (remember since we
<em>maximize</em> profit we negate the objective function <code>profit_obj</code>):</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>profit_result <span class="op">=</span> linprog((<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>profit_obj,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                        A_eq <span class="op">=</span> Aeq_profit,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                        b_eq <span class="op">=</span> beq_profit,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                        A_ub <span class="op">=</span> Aub_profit,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>                        b_ub <span class="op">=</span> bub_profit)</span></code></pre></div>
<p>This shows that the maximum profit is $4,800.00.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>profit_result.fun</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="op">-</span><span class="fl">4800.00</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> report(profit_result.x)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>Source     <span class="op">-&gt;</span> Santa Fe  :   <span class="fl">400.00</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>Source     <span class="op">-&gt;</span> El Paso   :   <span class="fl">200.00</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>Source     <span class="op">-&gt;</span> Tampa Bay :    <span class="fl">50.00</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> Chicago   :   <span class="fl">200.00</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> LA        :   <span class="fl">200.00</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> Houston   :     <span class="fl">0.00</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>Santa Fe   <span class="op">-&gt;</span> Atlanta   :     <span class="fl">0.00</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>El Paso    <span class="op">-&gt;</span> LA        :     <span class="fl">0.00</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>El Paso    <span class="op">-&gt;</span> Houston   :   <span class="fl">200.00</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>El Paso    <span class="op">-&gt;</span> Atlanta   :     <span class="fl">0.00</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>Tampa Bay  <span class="op">-&gt;</span> NY        :    <span class="fl">50.00</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>Tampa Bay  <span class="op">-&gt;</span> Houston   :     <span class="fl">0.00</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>Tampa Bay  <span class="op">-&gt;</span> Atlanta   :     <span class="fl">0.00</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> Chicago   :     <span class="fl">0.00</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> LA        :     <span class="fl">0.00</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> NY        :   <span class="fl">200.00</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> Atlanta   :     <span class="fl">0.00</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> Chicago   :     <span class="fl">0.00</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> NY        :    <span class="op">-</span><span class="fl">0.00</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> Houston   :     <span class="fl">0.00</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>Chicago    <span class="op">-&gt;</span> Demand    :   <span class="fl">200.00</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>LA         <span class="op">-&gt;</span> Demand    :   <span class="fl">200.00</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>NY         <span class="op">-&gt;</span> Demand    :   <span class="fl">250.00</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>Houston    <span class="op">-&gt;</span> Demand    :     <span class="fl">0.00</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>Atlanta    <span class="op">-&gt;</span> Demand    :     <span class="fl">0.00</span></span></code></pre></div>
<p>Notice that in maximizing profit, we didn’t use all available ducks
(e.g. 700 ducks were available in Santa Fe, but we only used 400 of
them).</p>
<p>And we didn’t meet demand in all store cities. The configuration
quoted by <code>linprog</code> yields a situation where we sold <em>no</em> ducks in
Houston and Atlanta, but it is of course possible that we could
achieve the same profit with a different flow in which some ducks were
sold in Houston and Atlanta.</p>
        </main>

        <footer>
	  <nav>
	    <a href="http://www.tufts.edu">
	      <i class="fas fa-chalkboard"></i>
	      Tufts
	    </a>	    
	    <a href="http://math.tufts.edu">
	      <i class="fas fa-chalkboard-teacher"></i>
	      Tufts Math
	    </a>
	    <a href="https://gmcninch-tufts.github.io/math">
	      <i class="fas fa-coffee"></i>
	      G McNinch
	    </a>
	    <a href="https://github.com/gmcninch-tufts">
	      <i class="fab fa-github"></i>
	      GitHub
	    </a>	    
	  </nav>
        </footer>
    </body>
</html>
