<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Math87-Tufts University - week02-02--lagrange</title>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
	</script>	
        <link rel="stylesheet" href="../css/default.css" />
	<link rel="stylesheet" href="../css/haddock.css" />
	
	<link href="https://fonts.googleapis.com/css?family=Lato:400,700" type="text/css" rel="stylesheet" media="screen" />
	<link href="https://fonts.googleapis.com/css?family=Arimo:400,700" type="text/css" rel="stylesheet" media="screen" />
	<link href="https://fonts.googleapis.com/css?family=Roboto:400,700" type="text/css" rel="stylesheet" media="screen" />
	<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700" type="text/css" rel="stylesheet" media="screen" />
	<link href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" type="text/css" rel="stylesheet" media="screen" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous" />			
    </head>
    <body>
        <header>
          <div class="logo">
            <a href="../">
	      Math87 - Spring 2024 - Tufts Univ</a>
          </div>
          <nav>
            <a href="../about.html">About</a>
	    <a href="../course-pages/Math087--course-info.html">Info</a>	    
            <a href="../archive.html">Archive</a>
          </nav>
        </header>

        <main role="main">
            <h1>week02-02--lagrange</h1>
            <div id="7b6de82e-6b77-4ff6-b685-105ef2f84445" class="cell markdown">

</div>
<div id="63b091ac-a60c-4859-ac65-231ef7cf266c" class="cell markdown">
<h1 id="george-mcninch-math-87---spring-2024"><a href="http://gmcninch.math.tufts.edu">George McNinch</a> Math 87 - Spring 2024</h1>
<h1 id="week-2">Week 2</h1>
<h1 id="-lagrange-multipliers">§ Lagrange multipliers</h1>
</div>
<div id="29f73841-bf7f-4b7b-8355-62adee4aeb0b" class="cell markdown">
<h1 id="some-motivation">Some motivation</h1>
<p>Let’s recall our television manufacturing example for a moment. The
model we solved was interesting but most likely unrealistic. A
manufacturer, for instance, probably has a limited capacity and can only
produce a certain amount of TVs in total per year.</p>
<p>Let’s look at an example where that capacity is 10,000 TVs per year.</p>
<p>So given the <em>constraint</em>, <span class="math inline">\(s + t ≤ 10,000\)</span>, how many of each model
should they produce now??</p>
<p>Well, first notice that the <em>unconstrained optimum</em> ofwith <span class="math inline">\(s = 4,735\)</span>
and <span class="math inline">\(t = 7,043\)</span>, does not satisfy the constraint.</p>
<p>Now let’s recall that in the single variable case, trying to find a
<em>constrained optimum</em> amounts t optimizing a function on a closed
interval – so you proceed with the usual procedure for optimization but
must also check boundary points (endpoints).</p>
<p>If we proceed in this fashion, we’d check the “boundary” conditions
corresponding to <span class="math inline">\(t=0\)</span> and <span class="math inline">\(s=0\)</span>.</p>
<p>Well, setting <span class="math inline">\(t=0\)</span> we see that the profit function is given by</p>
<p><span class="math display">\[P(s,0) = 144s - 0.01s^2 - 400,000.\]</span></p>
<p>Since this is a function only of <span class="math inline">\(s\)</span> we can use 1-dimensional
optimization techniques:</p>
<p><span class="math display">\[\dfrac{\partial P}{\partial S}(S,0) = 144 - 0.02s = 0 \implies s = 7,200.\]</span></p>
<p>On this boundary, we need to consider <span class="math inline">\((0,0)\)</span> and <span class="math inline">\((10,000,0)\)</span> (the
boundary of the boundary…) as well as <span class="math inline">\((7,200,0)\)</span>.</p>
<p>We can treat the boundary with <span class="math inline">\(s =0\)</span> similarly.</p>
<p>But the boundary condition with <span class="math inline">\(s+t = 0\)</span> will be more of a pain.</p>
<p>The method of Lagrange multipliers gives a more systematic way to
proceed!</p>
</div>
<div id="5821332f-965b-4cec-a7ec-ca8a1f1a23db" class="cell markdown">
<h1 id="lagrange-multipliers">Lagrange multipliers</h1>
<p>Consider a function <span class="math inline">\(f(x,y)\)</span> of two variables. We are interested here in
finding maximal or minimal values of <span class="math inline">\(f\)</span> subject to a <em>constraint</em>. The
sort of constraint we have in mind is a restriction on the possible
pairs <span class="math inline">\((x,y)\)</span> – so we have a second function <span class="math inline">\(g(x,y)\)</span> and we want to
maximize (or minimize) <span class="math inline">\(f\)</span> subject to the condition that <span class="math inline">\(g(x,y) = c\)</span>
for some fixed quantity <span class="math inline">\(c\)</span>.</p>
<p>We introduce a “new” function – now of <em>three</em> variables - known as the
<strong>Lagrangian</strong>. It is given by the formula <span class="math display">\[F(x,y,\lambda) =
f(x,y) - \lambda \cdot (c-g(x,y))\]</span></p>
<p>(We use the Greek letter <span class="math inline">\(\lambda\)</span> for our third variable in part
because it plays a different role for us than the variables <span class="math inline">\(x,y\)</span>).</p>
<p>We can calculate the <em>partial derivatives</em> of this Lagrangian; they are:</p>
<p><span class="math display">\[\dfrac{\partial F}{\partial x} = \dfrac{\partial f}{\partial x} -
\lambda\dfrac{\partial g}{\partial x}\]</span></p>
<p><span class="math display">\[\dfrac{\partial F}{\partial y} = \dfrac{\partial f}{\partial y} -
\lambda\dfrac{\partial g}{\partial y}\]</span></p>
<p><span class="math display">\[\dfrac{\partial F}{\partial \lambda} = c-g(x,y)\]</span></p>
<p>If we seek critical points of the Lagrangian, we find that</p>
<p><span class="math display">\[0 = \dfrac{\partial F}{\partial x} = \dfrac{\partial f}{\partial
x} - \lambda\dfrac{\partial g}{\partial x}\]</span></p>
<p>and similarly for <span class="math inline">\(y\)</span>, so that</p>
<p><span class="math display">\[ \dfrac{\partial f}{\partial x} = \lambda \dfrac{\partial
g}{\partial x} \quad \text{and}\quad \dfrac{\partial f}{\partial y} =
\lambda \dfrac{\partial g}{\partial y}\]</span></p>
<p>i.e. <span class="math display">\[ \left (\dfrac{\partial f}{\partial x} \mathbf{i} +
\dfrac{\partial f}{\partial y} \mathbf{j} \right) = \lambda \left
(\dfrac{\partial g}{\partial x} \mathbf{i} + \dfrac{\partial
g}{\partial y} \mathbf{j} \right)\]</span></p>
<p>(Recall that
<span class="math inline">\(\dfrac{\partial f}{\partial x} \mathbf{i} + \dfrac{\partial f}{\partial y} \mathbf{j}\)</span>
is the <em>gradient</em> <span class="math inline">\(\nabla f\)</span> of <span class="math inline">\(f\)</span>).</p>
<p>Moreover, we find that <span class="math display">\[0 = \dfrac{\partial F}{\partial \lambda} =
c - g(x,y).\]</span></p>
<p>Summarizing, the condition that <span class="math inline">\((x_0,y_0,\lambda_0)\)</span> is a critical
point of <span class="math inline">\(F\)</span> is equivalent to two requirements:</p>
<ul>
<li><strong>(A)</strong> <span class="math inline">\((x_0,y_0)\)</span> must be on the level curve <span class="math inline">\(g(x,y) = c\)</span>, and</li>
<li><strong>(B)</strong> the gradient vectors must satisfy
<span class="math inline">\(\nabla f \vert_{(x_0,y_0)} = \lambda_0 \nabla g \vert_{(x_0,y_0)}\)</span>.</li>
</ul>
<h2 id="the-crucial-assertion-is-this">The crucial assertion is this:</h2>
<blockquote>
<p>Optimal values for <span class="math inline">\(f\)</span> along the level curve <span class="math inline">\(g(x,y) = c\)</span> will be
found among the critical points of <span class="math inline">\(F\)</span>.</p>
</blockquote>
<p>Indeed, suppose <span class="math inline">\((x_0,y_0)\)</span> is a point on the level curve at which <span class="math inline">\(f\)</span>
takes its max (or min) value (on the level surface). We need to argue
that the gradient vector <span class="math inline">\(\nabla f \vert_{(x_0,y_0)}\)</span> is “parallel” to
the gradient vector <span class="math inline">\(\nabla g \vert_{(x_0,y_0)}\)</span> – i.e. <strong>(B)</strong> above
holds.</p>
<p>More precisely, we can write
<span class="math inline">\(\nabla f \vert_{(x_0,y_0)} = \mathbf{v} + \mu \nabla g \vert_{(x_0,y_0)}\)</span>
for a vector <span class="math inline">\(\mathbf{v}\)</span> perpendicular to <span class="math inline">\(\nabla g \vert_{(x_0,y_0)}\)</span>
(and for some scalar <span class="math inline">\(\mu\)</span>). And we must argue that <span class="math inline">\(\mathbf{v}\)</span> is
zero.</p>
<p>But if <span class="math inline">\(\mathbf{v}\)</span> is non-zero, then walking along the level curve
<span class="math inline">\(g(x,y) = c\)</span> “in the direction of <span class="math inline">\(\mathbf{v}\)</span>” will lead to higher
values of <span class="math inline">\(f\)</span>, contrary to the assumption that on the level curve, <span class="math inline">\(f\)</span>
has a maximum at <span class="math inline">\((x_0,y_0)\)</span>. <span class="math inline">\(\quad \blacksquare\)</span></p>
</div>
<div id="7ef8057c-8c6f-4aab-853f-92a1ef3d470a" class="cell markdown">
<h1 id="televisions-again">Televisions, again</h1>
<p>Let’s return to the television manufacturing problem. We consider the
constraint <span class="math display">\[g(s, t) = s + t = 10,000\]</span> i.e. “the manufacturer produces
exactly 10,000 televisions”.</p>
<p>Consider the <em>Lagrangian</em> function
<span class="math inline">\(F(s,t,\lambda) = P(s,t) - \lambda(s+t-10,000).\)</span></p>
<p>Looking for critical points of <span class="math inline">\(F\)</span>, we find that:</p>
<p><span class="math display">\[ \left \{ \begin{matrix} \dfrac{\partial P}{\partial s} - \lambda
\dfrac{\partial g}{\partial s} &amp;=&amp; 144 − 0.02s − 0.007t − λ &amp;= 0 \\
\dfrac{\partial P}{\partial t} - \lambda \dfrac{\partial g}{\partial
t} &amp;=&amp; 174 − 0.007s − 0.002t − λ &amp;= 0 \\ g(s,t) - c &amp;=&amp; -10000 +s +t
&amp;= 0 \end{matrix} \right .\]</span></p>
<p>This leads to 3 linear equations in 3 unknowns, which we can easily
solve with <code>numpy</code> (or by hand!):</p>
</div>
<div id="ec4cd95c-d167-4aa3-b7e5-39fa8f269a3b" class="cell code">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">## coefficient matrix</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>M<span class="op">=</span>np.array([[<span class="fl">0.02</span>,<span class="fl">.007</span>,<span class="dv">1</span>],[<span class="fl">.007</span>,<span class="fl">.02</span>,<span class="dv">1</span>],[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>]])</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>b<span class="op">=</span>np.array([<span class="dv">144</span>,<span class="dv">174</span>,<span class="dv">10000</span>])</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>np.linalg.solve(M,b)</span></code></pre></div>
</div>
<div id="887f3020-1856-4ddc-b073-4d8a2aa5da30" class="cell markdown">
<p>We find that <span class="math inline">\(s \approx 3,846\)</span>, <span class="math inline">\(t \approx 6,154\)</span> and <span class="math inline">\(λ = 24\)</span>.</p>
</div>
<div id="33062a77-b5c2-4d48-bae0-5f0c04b5bf0d" class="cell markdown">
<p>Now, effectively we consider the profit function <span class="math inline">\(P\)</span> subject to the
constraint <span class="math inline">\(s+t=10,000\)</span> where <span class="math inline">\(s \ge 0\)</span> and <span class="math inline">\(t \ge 0\)</span>. On this “closed
interval”, the function <span class="math inline">\(P\)</span> will assume a maximum and a minimum value.
We’ve found the “critical point” of <span class="math inline">\(P\)</span> on this “interval” – namley
<span class="math inline">\((3846, 6154)\)</span>. The <em>endpoints</em> of the interval are <span class="math inline">\((0,10000)\)</span> and
<span class="math inline">\((10000,0)\)</span>.</p>
<p>Let’s compare the values of <span class="math inline">\(P\)</span> at these points of interest:</p>
</div>
<div id="2f910652-1132-471a-a675-7ab9861978d3" class="cell code">
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> p(s,t):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">400000</span> <span class="op">+</span> <span class="dv">144</span><span class="op">*</span>s <span class="op">+</span> <span class="dv">174</span><span class="op">*</span>t <span class="op">-</span> <span class="fl">0.01</span><span class="op">*</span>s<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="fl">0.01</span><span class="op">*</span>t<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="fl">.007</span><span class="op">*</span>s<span class="op">*</span>t</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>[p(<span class="dv">0</span>,<span class="dv">10000</span>), p(<span class="dv">3846</span>,<span class="dv">6154</span>), p(<span class="dv">10000</span>,<span class="dv">0</span>)]</span></code></pre></div>
</div>
<div id="ba3c911f-7d07-47cf-9f87-f95114a468e7" class="cell markdown">
<p>This shows that the <em>maximum constrained profit</em> is <span class="math display">\[P(3846 , 6154) =
532308.\]</span></p>
<p>(what choice of <span class="math inline">\(s,t\)</span> give the minimum constrained profit? Could you
have guessed that <em>a priori</em>?)</p>
</div>
<div id="30a56a66-86ad-4739-b283-32d99d95463f" class="cell markdown">
<h1 id="shadow-prices-and-an-interpretation-for-the-multiplier-lambda">Shadow prices and an interpretation for the “multiplier” <span class="math inline">\(\lambda\)</span></h1>
<p>Let’s carry out <em>sensitivity analysis</em> on the value of the <em>constraint</em>.</p>
<p>Recall that our constraint is <span class="math inline">\(g(s,t) = s+t = 10000\)</span>. So we instead set
<span class="math display">\[g(s,t) = s + t = c.\]</span></p>
<p>In this case, we must instead solve the system of equations <span class="math inline">\(Mx = b\)</span>
where <span class="math display">\[M = \begin{pmatrix} 0.02 &amp; 0.007 &amp; 1 \\ 0.007 &amp; 0.02 &amp; 1 \\ 1
&amp; 1 &amp; 0 \end{pmatrix} \quad \text{and} \quad b = \begin{pmatrix} 144
\\ 174 \\ c \end{pmatrix}\]</span></p>
<p>Since the vector <span class="math inline">\(b\)</span> has an “unknown”, we can’t seem to use the
<code>linalg.solve</code> method. We can circumvent this by inverting the
coefficient matrix. We must also introduce a <code>symbol</code> for the unknown
<code>c</code>.</p>
</div>
<div id="af1a1330-cc5d-4d08-9fd4-9f3fa5f9e1dc" class="cell code">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">## coefficient matrix</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>M<span class="op">=</span>np.array([[<span class="fl">0.02</span>,<span class="fl">0.007</span>,<span class="dv">1</span>],[<span class="fl">0.007</span>,<span class="fl">0.02</span>,<span class="dv">1</span>],[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>]])</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">## inverse of coefficient matrix</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>Mi <span class="op">=</span> np.linalg.inv(M)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> sp.Symbol(<span class="st">'c'</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>b<span class="op">=</span>np.array([<span class="dv">144</span>,<span class="dv">174</span>,c])</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>np.matmul(Mi,b)</span></code></pre></div>
</div>
<div id="c2d5b634-d990-4b6e-9022-5e0c00c79316" class="cell markdown">
<p>So we see that the solution has <span class="math display">\[s = \dfrac{c}{2} - 1153.85 \qquad t
= \dfrac{c}{2} + 1153.85 \qquad \text{and} \qquad \lambda = 159
- 0.0135c.\]</span></p>
<p>Thus <span class="math inline">\(\dfrac{ds}{dc} = \dfrac{dt}{dc} = \dfrac{1}{2}\)</span> so that
<span class="math display">\[S(s,c=10000) \approx 1.3 \quad S(t,c=10000) \approx 0.8\]</span> which shows
that increasing the maximum production of TVs will increase the optimal
production levels.</p>
<p>What about the sensitivity <span class="math inline">\(S(P,c) = \dfrac{dP}{dc} \cdot \dfrac{c}{P}\)</span>?</p>
<p>To compute <span class="math inline">\(\dfrac{dP}{dc}\)</span> we can use the several-variable chain rule,
or just rewrite <span class="math inline">\(P\)</span> as a function of <span class="math inline">\(c\)</span>. After some calculation, we
find that <span class="math display">\[S(P,c=10000) \approx 24 \cdot
\dfrac{10000}{532308} \approx 0.45.\]</span> So a 1% increase in <span class="math inline">\(c\)</span> yields a
<span class="math inline">\(0.45%\)</span> increase in <span class="math inline">\(P\)</span>.</p>
<p>Interestingly, observe that <span class="math display">\[\dfrac{dP}{dc} = \lambda.\]</span></p>
<p>Let’s pause to recall that with the method of Lagrange multipliers, the
value of gradient of the function we are optimizing – <span class="math inline">\(P\)</span> in this case
– at a candidate optimal point is proportional to the value of the
gradient of <span class="math inline">\(g\)</span>: <span class="math display">\[ \nabla(P)_{(s_0,t_0)} = \lambda
\nabla(g)_{(s_0,t_0)}\]</span></p>
<p>One refers to <span class="math inline">\(\dfrac{\partial P}{\partial c}\)</span> as the <strong>shadow price</strong>
– increasing <span class="math inline">\(c\)</span> by 1 unit in this case increases <span class="math inline">\(P\)</span> by about $24.</p>
<p>Thus, the Lagrange multiplier, λ actually has a “physical” meaning here.
If you are allowed to produce more TV’s it tells you how much that
change affects your profit. Therefore, if the cost of making that change
is less than the additional profit, you probably should go for it!</p>
</div>
        </main>

        <footer>
	  <nav>
	    <a href="http://www.tufts.edu">
	      <i class="fas fa-chalkboard"></i>
	      Tufts
	    </a>	    
	    <a href="http://math.tufts.edu">
	      <i class="fas fa-chalkboard-teacher"></i>
	      Tufts Math
	    </a>
	    <a href="https://gmcninch-tufts.github.io/math">
	      <i class="fas fa-coffee"></i>
	      G McNinch
	    </a>
	    <a href="https://github.com/gmcninch-tufts">
	      <i class="fab fa-github"></i>
	      GitHub
	    </a>	    
	  </nav>
        </footer>
    </body>
</html>
