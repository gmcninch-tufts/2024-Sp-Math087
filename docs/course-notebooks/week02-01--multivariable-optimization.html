<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Math87-Tufts University - week02-01--multivariable-optimization</title>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
	</script>	
        <link rel="stylesheet" href="../css/default.css" />
	<link rel="stylesheet" href="../css/haddock.css" />
	
	<link href="https://fonts.googleapis.com/css?family=Lato:400,700" type="text/css" rel="stylesheet" media="screen" />
	<link href="https://fonts.googleapis.com/css?family=Arimo:400,700" type="text/css" rel="stylesheet" media="screen" />
	<link href="https://fonts.googleapis.com/css?family=Roboto:400,700" type="text/css" rel="stylesheet" media="screen" />
	<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700" type="text/css" rel="stylesheet" media="screen" />
	<link href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" type="text/css" rel="stylesheet" media="screen" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous" />			
    </head>
    <body>
        <header>
          <div class="logo">
            <a href="../">
	      Math87 - Spring 2024 - Tufts Univ</a>
          </div>
          <nav>
            <a href="../about.html">About</a>
	    <a href="../course-pages/Math087--course-info.html">Info</a>	    
            <a href="../archive.html">Archive</a>
          </nav>
        </header>

        <main role="main">
            <h1>week02-01--multivariable-optimization</h1>
            <div id="ae884330-8fe0-4e80-a185-9dfacce4accc" class="cell markdown">

</div>
<div id="1ecadfa0-57b3-4ecb-a091-ee09e6f7a73d" class="cell markdown">
<h1 id="george-mcninch-math-87---spring-2024"><a href="http://gmcninch.math.tufts.edu">George McNinch</a> Math 87 - Spring 2024</h1>
<h1 id="multi-variable-optimization">§ Multi-variable Optimization</h1>
</div>
<div id="34c4fcd8-ff55-4e9a-a968-4e3a2cf7e0ef" class="cell markdown">
<h1 id="optimization-with-functions-of-several-variables">Optimization with functions of several variables</h1>
<p>Consider a function <span class="math inline">\(f(x,y)\)</span> of two variables. You learned in Calculus 3
(<em>vector calculus</em>) how to search for the points <span class="math inline">\((x,y)\)</span> in the plane
<span class="math inline">\(ℝ²\)</span> at which <span class="math inline">\(f\)</span> assumes its maximum and minimum value. Let’s briefly
recap this story.</p>
<p>Recall that for a function of a single variable, critical points are
those points for which the tangent line is horizontal. In the single
variable case, the criteria depends instead on the <em>tangent plane</em>.</p>
<p>Recall that the surface defined by <span class="math inline">\(z = f(x,y)\)</span> can be <em>parameterized</em>
by <span class="math inline">\(\mathbf{r}(x,y) = (x,y,f(x,y))\)</span>. So a <strong>normal vector</strong> to this
surface at a point <span class="math inline">\(P = (x_0,y_0,f(x_0,y_0))\)</span> on the surface is given by
the <em>cross product</em> <span class="math display">\[\left (\dfrac{\partial \mathbf{r}}{\partial
x} \times \dfrac{\partial \mathbf{r}}{\partial y}\right)_P.\]</span></p>
<p>Alternatively, consider <span class="math inline">\(F(x,y,z) = z-f(x,y)\)</span> so that the surface is
defined by <span class="math inline">\(F = 0\)</span>. Then the gradient <span class="math inline">\(\nabla F\)</span> defines a normal vector
at each point <span class="math inline">\(P\)</span>, where <span class="math display">\[(\nabla F)_P = \left(\dfrac{\partial
F}{\partial x} \mathbf{i} + \dfrac{\partial F}{\partial y}
\mathbf{j} + \dfrac{\partial F}{\partial z} \mathbf{k}\right)_P\]</span>.</p>
<p>There is a nice discussion here: <a href="https://en.wikipedia.org/wiki/Normal_(geometry)"><strong>normal
vector</strong></a>. Both points
of view can be useful, but here they lead to the same formula. At the
point <span class="math inline">\(P=(x_0,y_0,f(x_0,y_0))\)</span> one has a normal to the surface defined
by <span class="math inline">\(z = f(x,y)\)</span> given by <span class="math display">\[\mathbf{n}\vert_P = \left (
\mathbf{i} + \dfrac{\partial f}{\partial x} \mathbf{k} \right )_P
\times \left ( \mathbf{j} + \dfrac{\partial f}{\partial y} \mathbf{k}
\right )_P = \left ( \mathbf{k} - \dfrac{\partial f}{\partial x}
\mathbf{i} - \dfrac{\partial f}{\partial y} \mathbf{j} \right )_P\]</span></p>
<p>Now, the <strong>tangent plane</strong> at <span class="math inline">\(P\)</span> to the surface <span class="math inline">\(z = f(x,y)\)</span> is just
the plane orthogonal to this normal vector <span class="math inline">\(\mathbf{n}_P\)</span>. Thus, the
tangent plane at <span class="math inline">\(P\)</span> is horizontal – parallel to the <span class="math inline">\(x,y\)</span>-plan – just
in case this normal vector points in the <span class="math inline">\(\mathbf{k}\)</span> direction –
i.e. provided that <span class="math display">\[(\clubsuit) \quad
\dfrac{\partial{f}}{\partial{x}} \bigg\vert_{(x_0,y_0)} = 0 \quad
\text{and} \quad \dfrac{\partial{f}}{\partial{y}}
\bigg\vert_{(x_0,y_0)} = 0\]</span></p>
<p>Mimicking the one variable case, we say that the points <span class="math inline">\((x_0,y_0)\)</span> for
which the tangent plane to the surface <span class="math inline">\(P=(x_0,y_0,f(x_0,y_0))\)</span> is
horizontal are the <em>critical points</em>.</p>
<p>So we find the critical points by simultaneously solving the equations
<span class="math inline">\((\clubsuit)\)</span>.</p>
<p>There is a <em>second derivative test</em> which gives information about the
“max/min status” of these critical points.</p>
<p>To use this test, consider the matrix of second partial derivatives</p>
<p><span class="math display">\[M(x_0,y_0) = 
  \begin{pmatrix} 
  \dfrac{\partial^2 f}{\partial x^2} &amp;
  \dfrac{\partial^2 f}{\partial x \partial y} \\ 
  \dfrac{\partial^2 f}{\partial y \partial x} &amp; \dfrac{\partial^2 f}{\partial y^2} 
\end{pmatrix} \Bigg\vert_{(x_0,y_0)}.\]</span></p>
<p>For reasonable functions, the “mixed partials”
<span class="math inline">\(\dfrac{\partial^2 f}{\partial x \partial y}\)</span> and
<span class="math inline">\(\dfrac{\partial^2 f}{\partial y \partial x}\)</span> coincide.</p>
<p>Remember that the determinant of a <span class="math inline">\(2 \times 2\)</span> matrix
<span class="math inline">\(\begin{pmatrix} a &amp; b \\ c &amp; d \end{pmatrix}\)</span> is <span class="math inline">\(ad - bc\)</span>.</p>
<p>So, provided that <span class="math inline">\(f\)</span> is a reasonable function, the <em>determinant</em> of <span class="math inline">\(M\)</span>
is given by the expression</p>
<p><span class="math display">\[D=D(x_0,y_0) = \left(\dfrac{\partial^2 f}{\partial
  x^2}\cdot\dfrac{\partial^2 f}{\partial y^2} -
  \left[\dfrac{\partial^2 f}{\partial x \partial y}\right]^2\right)
  \bigg\vert_{(x_0,y_0)} \]</span></p>
<p>Suppose that <span class="math inline">\((x_0,y_0)\)</span> is a critical point. Here is what the second
derivative test tells us:</p>
<ul>
<li>If <span class="math inline">\(D&gt;0\)</span> and
<span class="math inline">\(\dfrac{\partial^2 f}{\partial x^2}\bigg\vert_{(x_0,y_0)}&lt;0\)</span>, then
<span class="math inline">\(f(x,y)\)</span> has a relative maximum at <span class="math inline">\((x_0,y_0)\)</span>.</li>
<li>If <span class="math inline">\(D&gt;0\)</span> and
<span class="math inline">\(\dfrac{\partial^2 f}{\partial x^2}\bigg\vert_{(x_0,y_0)}&gt;0\)</span>, then
<span class="math inline">\(f(x,y)\)</span> has a relative minimum at <span class="math inline">\((x_0,y_0)\)</span>.</li>
<li>If <span class="math inline">\(D&lt;0\)</span>, then <span class="math inline">\(f(x,y)\)</span> has a saddle point at <span class="math inline">\((x_0,y_0)\)</span>.</li>
<li>If <span class="math inline">\(D=0\)</span>, the second derivative test is inconclusive.</li>
</ul>
</div>
<div id="acf77f15-1e1f-4ab7-b344-a4096a26f946" class="cell code" data-execution_count="1">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># https://matplotlib.org/mpl_toolkits/mplot3d/tutorial.html</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># https://matplotlib.org/3.3.1/gallery/mplot3d/surface3d.html</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> draw_graph(f,x,y,x0,y0,elev_azim<span class="op">=</span>[]):</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    X,Y <span class="op">=</span> np.meshgrid(x,y)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">20</span>))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx,(e,a) <span class="kw">in</span> <span class="bu">enumerate</span>(elev_azim,start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="bu">len</span>(elev_azim),idx,projection<span class="op">=</span><span class="st">'3d'</span>,elev<span class="op">=</span>e,azim<span class="op">=</span>a)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        ax.plot_wireframe(X,Y,f(X,Y))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        ax.plot(x,y0<span class="op">*</span>np.ones(y.shape), zs<span class="op">=</span> f(x,y0), color<span class="op">=</span><span class="st">&quot;red&quot;</span>, linewidth<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        ax.plot(x0<span class="op">*</span>np.ones(x.shape),y, zs<span class="op">=</span> f(x0,y), color<span class="op">=</span><span class="st">&quot;red&quot;</span>, linewidth<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fig</span></code></pre></div>
</div>
<div id="abc01ea8-548a-4e89-bbf4-e68ef255a133" class="cell code" data-execution_count="2">
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x,y):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>af<span class="op">=</span>draw_graph(f,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>              x<span class="op">=</span>np.linspace(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">25</span>),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>              y<span class="op">=</span>np.linspace(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">25</span>),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>              x0<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>              y0<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>              elev_azim<span class="op">=</span>[(<span class="dv">35</span>,<span class="dv">15</span>),(<span class="dv">35</span>,<span class="dv">30</span>),(<span class="dv">35</span>,<span class="dv">75</span>)])</span></code></pre></div>
<div class="output display_data">
<p><img src="187f7c6a7ee678b12c5d722bbab00faee206a40f.png" /></p>
<pre><code>&lt;Figure size 2000x2000 with 3 Axes&gt;</code></pre>
</div>
</div>
<div id="73a60cdd-b142-4ee3-969b-81951517f74d" class="cell markdown">
<h1 id="example-television-manufacturer"><strong>Example:</strong> Television manufacturer</h1>
<p>Consider a television manufacturer which sells two models of TVs: a 19”
set and a 21” set.</p>
<p>Their annual production costs are \$ 195 per TV for the 19” model and
\$ 225 per TV for the 21” model, plus \$ 400,000 per year in fixed
costs.</p>
<p>They expect to sell their production to a single wholesaler who will pay
a base price of \$ 339 per 19” TV and $ 399 per 21” TV. The
wholesaler receives a volume discount calculated as 1¢ per 19” TV + 0.3¢
per 21” TV for the 19” models and 1¢ per 21” TV + 0.4¢ per 19” TV for
the 21” models.</p>
<p>How many 19” and 21” TVs should be produced to maximize the profits?</p>
</div>
<div id="a0177348-8e54-48d5-81cb-02d9d5e73800" class="cell markdown">
<p>Let’s go through our modeling procedure. Let’s set up the problem and
ask the right questions.</p>
<p>What are our variables?</p>
<ul>
<li><span class="math inline">\(s\)</span> = # of 19” TVs produced</li>
<li><span class="math inline">\(t\)</span> = # of 21” TVs produced</li>
<li><span class="math inline">\(p\)</span> = selling price of each 19” TV</li>
<li><span class="math inline">\(q\)</span> = selling price of each 21” TV</li>
<li><span class="math inline">\(C\)</span> = cost of production</li>
<li><span class="math inline">\(R\)</span> = total revenue of sales</li>
<li><span class="math inline">\(P\)</span> = total profit</li>
</ul>
<p>What do we <em>know</em> to start with??</p>
<ul>
<li><span class="math inline">\(p(s,t) = 339 − 0.01s − 0.003t\)</span> dollars</li>
<li><span class="math inline">\(q(s,t) = 399 − 0.004s − 0.01t\)</span> dollars</li>
<li><span class="math inline">\(R(s,t) = ps + qt = 339s − 0.01s^2 − 0.003st + 399t − 0.004st − 0.01t^2\)</span>
so that
<span class="math display">\[R(s,t) = 339s + 399t − 0.01s^2 − 0.01t^2 − 0.007st \quad \text{dollars}.\]</span><br />
</li>
<li><span class="math inline">\(C(s,t) = 400, 000 + 195s + 225t\)</span> dollars</li>
<li><span class="math inline">\(P(s,t) = R(s,t) - C(s,t)\)</span> so that
<span class="math display">\[P(s,t) =  −400, 000 + 144s + 174t − 0.01s^2 − 0.01t^2 − 0.007st \quad \text{dollars}.\]</span></li>
</ul>
<hr />
<p>Of course, our goal is to maximize profit – i.e. to find <span class="math inline">\((s_0,t_0)\)</span> for
which <span class="math inline">\(P(s_0,t_0)\)</span> is at a maximum.</p>
<p>According to the discussion above, we should compute the partial
derivitives of <span class="math inline">\(P\)</span> and simultaneously solve the equations <span class="math display">\[0 =
  \dfrac{\partial P}{\partial s} = \dfrac{\partial P}{\partial t}\]</span></p>
<p>So we need to solve the equations:</p>
<p><span class="math display">\[\dfrac{\partial P}{\partial s} = 144 − 0.02s − 0.007t = 0\]</span></p>
<p><span class="math display">\[\dfrac{\partial P}{\partial t} = 174 − 0.02t − 0.007s = 0\]</span></p>
<p>This amounts to solving the matrix equation</p>
<p><span class="math display">\[\begin{bmatrix} 0.02 &amp; 0.007 \\ 0.007 &amp; 0.02 \end{bmatrix} \begin{bmatrix} s \\ t \end{bmatrix}
    = \begin{bmatrix} 144 \\ 174 \end{bmatrix}\]</span></p>
<p>which we can solve using <em>row reduction</em> on the corresponding augmented
matrix:</p>
<p><span class="math display">\[\left[\begin{array}{rr|r} 0.02 &amp; 0.007 &amp; 144 \\
                   0.007 &amp; 0.02 &amp; 174 \end{array} \right]
    \sim \left[\begin{array}{rr|r} 1 &amp; .35 &amp; 7200 \\
                   1 &amp; 2.857 &amp; 24857.14 \end{array} \right]
    \sim \left[\begin{array}{rr|r} 1 &amp; .35 &amp; 7200 \\
                   0 &amp; 2.507 &amp; 17657.14 \end{array} \right]
    \sim \left[\begin{array}{rr|r} 1 &amp; .35 &amp; 7200 \\
                   0 &amp; 1 &amp; 7043.135 \end{array} \right]
        \sim \left[\begin{array}{rr|r} 1 &amp; 0 &amp; 4734.9 \\
                   0 &amp; 1 &amp; 7043.135 \end{array} \right]\]</span></p>
<p>We find that the function <span class="math inline">\(P\)</span> has exactly one critical point which
occurs at <span class="math inline">\((s_0,t_0) = (4735,7043)\)</span>.</p>
<p>Let’s quickly pause and see how to solve this matrix equation using the
computer:</p>
</div>
<div id="d97315c4-3077-497c-ba38-e3c4798afd63" class="cell code">
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>A<span class="op">=</span> np.array([[<span class="fl">.02</span>,<span class="fl">.007</span>],[<span class="fl">.007</span>,<span class="fl">.02</span>]])</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=</span>np.array([<span class="dv">144</span>,<span class="dv">174</span>])</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>np.linalg.solve(A,b)</span></code></pre></div>
</div>
<div id="3bdcbe48-3c5a-47c4-a421-9772403ca3f5" class="cell markdown">
<p>The matrix of second derivatives is
<span class="math display">\[ \begin{bmatrix} \dfrac{\partial^2 P}{\partial s^2} &amp;
 \dfrac{\partial^2 P}{\partial s \partial t} \\ \dfrac{\partial^2
 P}{\partial s^2} &amp; \dfrac{\partial^2 P}{\partial s \partial t}
 \end{bmatrix} = \begin{bmatrix} -0.02 &amp; -0.007 \\ -0.007 &amp; -0.02
 \end{bmatrix}\]</span> which has determinant <span class="math inline">\((0.02)^2 - (.007)^2 &gt; 0\)</span>.</p>
<p>Since <span class="math inline">\(\dfrac{\partial^2 P}{\partial s^2} = -0.02 &lt; 0\)</span>, the second
derivative test shows that <span class="math inline">\(P\)</span> has is local maximum at <span class="math inline">\((s_0,t_0)\)</span>, and
we conclude that profit is maximized there.</p>
<p>(Technically, we should check for minima “on the boundary” but in this
case that would be the point <span class="math inline">\((0,0)\)</span> which clearly doesn’t maximize
<span class="math inline">\(P\)</span>).</p>
<p>Let’s produce a (or a few…) graph(s) to confirm our work:</p>
</div>
<div id="ad92bf8f-e0bd-4797-8493-1b416d09d03b" class="cell code">
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> np.linspace(<span class="dv">2000</span>,<span class="dv">8000</span>,<span class="dv">25</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.linspace(<span class="dv">2000</span>,<span class="dv">8000</span>,<span class="dv">25</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> p(s,t):</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">400000</span> <span class="op">+</span> <span class="dv">144</span><span class="op">*</span>s <span class="op">+</span> <span class="dv">174</span><span class="op">*</span>t <span class="op">-</span> <span class="fl">0.01</span><span class="op">*</span>s<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="fl">0.01</span><span class="op">*</span>t<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="fl">.007</span><span class="op">*</span>s<span class="op">*</span>t</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>draw_graph(p,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>             x<span class="op">=</span>s,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>             y<span class="op">=</span>t,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>             x0<span class="op">=</span><span class="dv">4735</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>             y0<span class="op">=</span><span class="dv">7043</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>             elev_azim<span class="op">=</span>[(<span class="dv">45</span>,<span class="dv">20</span>),(<span class="dv">45</span>,<span class="dv">55</span>)])</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
</div>
<div id="8a09fdba-8cb6-42f2-95bd-1da6b85f8d58" class="cell code">
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># countour plot</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>S,T <span class="op">=</span> np.meshgrid(s,t)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>figc <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">10</span>))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>axc <span class="op">=</span> figc.add_subplot()</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>axc.contourf(S,T,p(S,T),levels<span class="op">=</span><span class="dv">20</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>             , extend<span class="op">=</span><span class="st">'both'</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>axc.scatter(<span class="dv">4735</span>,<span class="dv">7043</span>,marker<span class="op">=</span><span class="st">&quot;X&quot;</span>)</span></code></pre></div>
</div>
<div id="247d4b56-9943-4063-8dda-f965fd533483" class="cell markdown">
<h1 id="sensitivity-analysis-the-television-example-continued">Sensitivity Analysis (the television example, continued)</h1>
<p>Just as in the single-variable case, we should be able to perform
<em>Sensitivity Analysis</em> for our optimization problems.</p>
<p>Let’s start by picking a parameter we want to change.</p>
<p><strong>Definition</strong>(Price Elasticity). Let the <em>Price Elasticity</em> parameter,
<span class="math inline">\(a\)</span>, be the amount the selling price of say the 19” TVs decreases per
19” TV sold.</p>
<p>We started with <span class="math inline">\(a = 0.01\)</span>.</p>
<p>Using this let’s rewrite the Profit equation with <span class="math inline">\(a\)</span>:</p>
<p><span class="math display">\[P(s,t) = 144s + 174t − as^2 − 0.01t^2 − 0.007st − 400000\]</span></p>
<p>We now look for optimal values <span class="math inline">\(s = s(a)\)</span> and <span class="math inline">\(t = t(a)\)</span> depending on
<span class="math inline">\(a\)</span>.</p>
<p>We need to solve the system: <span class="math display">\[\left\{\begin{matrix}
    0 &amp; = \dfrac{\partial P}{\partial s} = 144 -2as - 0.007t \\
    0 &amp; = \dfrac{\partial P}{\partial t}= 174 -.02t - 0.007s
  \end{matrix}\right .\]</span></p>
<p>Solving this system, find that <span class="math inline">\(s = s(a) = \dfrac{144-0.007t}{2a}\)</span> so
that <span class="math display">\[174 - 0.02t - 0.007\cdot \dfrac{144-0.007t}{2a} = 0\]</span> We now find
that <span class="math display">\[t = 8,700 - \dfrac{581,700}{40,000a -49}\]</span> and <span class="math display">\[s =
\dfrac{1,662,000}{40,000a-49}\]</span></p>
<p>Now we check the sensitivity:</p>
<p><span class="math display">\[S(s,a) = \dfrac{ds}{da} \cdot \dfrac{a}{s} \quad \text{and} \quad
S(t,a) = \dfrac{dt}{da} \cdot \dfrac{a}{t}\]</span></p>
<p>Thus</p>
<p><span class="math display">\[S(s,a) = \dfrac{66,480,000,000}{(40,000a - 49)^2} \cdot
            \dfrac{40,000a^2 - 49a}{1,662,000}\]</span> and <span class="math display">\[S(t,a) =
            \dfrac{23,268,000,000}{(40,000a - 40)^2} \cdot
            \dfrac{40,000a^2 - 49a}{8,700 \cdot (40,000a - 49) -
            581,700}\]</span></p>
<p>The sensitivity near our guess of <span class="math inline">\(a = 0.01\)</span> is thus</p>
<p><span class="math display">\[S(s,0.01) \approx -1.1 \quad \text{and} \quad S(t,0,01) \approx
  0.2\]</span></p>
<p><strong>Interpretation:</strong> If the price elasticity increases by 10% (i.e. the
warehouse receives a bigger bulk discount) the optimal value of <span class="math inline">\(s\)</span>
decreases by 11% and the optimal value of <span class="math inline">\(t\)</span> increases by 2.7%</p>
</div>
        </main>

        <footer>
	  <nav>
	    <a href="http://www.tufts.edu">
	      <i class="fas fa-chalkboard"></i>
	      Tufts
	    </a>	    
	    <a href="http://math.tufts.edu">
	      <i class="fas fa-chalkboard-teacher"></i>
	      Tufts Math
	    </a>
	    <a href="https://gmcninch-tufts.github.io/math">
	      <i class="fas fa-coffee"></i>
	      G McNinch
	    </a>
	    <a href="https://github.com/gmcninch-tufts">
	      <i class="fab fa-github"></i>
	      GitHub
	    </a>	    
	  </nav>
        </footer>
    </body>
</html>
